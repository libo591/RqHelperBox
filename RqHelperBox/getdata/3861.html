<html>
 <head></head> 
 <body> 
  <p>&nbsp;</p> 
  <p style="text-align: center;"> </p> 
  <div style="text-align: center;"> 
   <span style="font-size: 14pt;"><p></p> 
    <div style="text-align: center;"> 
     <strong>V4报表样式批量修改 </strong> 
    </div> <p></p></span> 
  </div> 
  <p><span style="font-size: 14pt;"><strong>&nbsp;</strong></span></p> 
  <strong> </strong> 
  <p><strong></strong></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><strong><span style="font-family: 宋体; font-size: 12pt;">需求背景</span></strong><strong>&nbsp;</strong></p> 
  <p class="MsoNormal" style="text-indent: 21pt; layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="text-indent: 21pt; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">在润乾</span><span style="font-size: 12pt;">v5</span><span style="font-family: 宋体; font-size: 12pt;">中提供了样式管理功能，可以灵活的进行全局样式或私有样式的管理，通过</span><span style="font-size: 12pt;">v5</span><span style="font-family: 宋体; font-size: 12pt;">的全局样式管理，可以实现对现有报表的批量样式修改功能。对于</span><span style="font-size: 12pt;">v4</span><span style="font-family: 宋体; font-size: 12pt;">，润乾并没有提供相应的全局样式管理功能，对于用户需要进行样式批量修改的功能，在</span><span style="font-size: 12pt;">v4</span><span style="font-family: 宋体; font-size: 12pt;">中我们可以间接的通过润乾的</span><span style="font-size: 12pt;">api</span><span style="font-family: 宋体; font-size: 12pt;">实现该功能。</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none; margin-left: 21pt;">&nbsp;</p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><strong><span style="font-family: 宋体; font-size: 12pt;">解决方案</span></strong><strong>&nbsp;</strong></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p> 
  <p class="MsoNormal" style="text-indent: 24pt; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">在润乾报表</span><span style="font-size: 12pt;">v4</span><span style="font-family: 宋体; font-size: 12pt;">中，<a href="http://www.runqian.com.cn">润乾报表</a>在系统运算过程中以对象的形态存在，报表的每一个单元格都有其各种属性，通过对各种属性的设置，我们可以改变单元格的样式，包括格线、背景色、前景色、字体等；</span></p> 
  <p class="MsoNormal" style="text-indent: 24pt; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">我们可以通过</span><span style="font-size: 12pt;">java</span><span style="font-family: 宋体; font-size: 12pt;">方法批量读取报表文件，然后遍历全部报表对象的单元格，将单元格属性信息回设到报表对象中，达到批量换肤的目的。</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><strong><span style="font-family: 宋体; font-size: 12pt;">实现原理</span></strong><strong></strong></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span style="font-size: 12pt;">1</span><span style="font-family: 宋体; font-size: 12pt;">、通过</span><span style="font-size: 12pt;">api</span><span style="font-family: 宋体; font-size: 12pt;">预定义报表样式，例如：</span><span style="font-size: 12pt;">ChangeReportStyle.java</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">package common.reader.raq;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">import com.runqian.report4.model.NormalCell;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">import com.runqian.report4.model.ReportDefine;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">import com.runqian.report4.model.RowCell;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">import com.runqian.report4.usermodel.INormalCell;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">import com.runqian.report4.util.ReportUtils;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">public class ChangeReportStyle {</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">。。。。。。</span>//<span style="font-family: 宋体; font-size: 12pt;">此处省略</span></span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp; </span>/**</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 宋体; font-size: 12pt;">根据行性质，设置行的属性</span><span style="font-size: 12pt;">,</span><span style="font-family: 宋体; font-size: 12pt;">根据实际需求进行修改。</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp; </span>* @param row</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp; </span>*/</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>public void setRowProperty(RowCell row) {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>byte rowType = row.getRowType();</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>switch (rowType) {<span>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_GROUP_HEADER): {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, true);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_TITLE_HEADER):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, true);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_TABLE_HEADER):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, true);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_PAGE_HEADER):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, true);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_NORMAL):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, false);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_TABLE_FOOTER):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, false);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_TITLE_FOOTER):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, false);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case (RowCell.TYPE_PAGE_FOOTER):</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>optimizeRow(row, false);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/**</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span></span><span style="font-family: 宋体; font-size: 12pt;">此方法，请根据实际需要进行调整</span><span style="font-size: 12pt;"> </span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span>* @param row</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span>* @param isHeader</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;</span>*/</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>public void optimizeRow(RowCell row, boolean isHeader) {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int r = currentRow;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>short c = 1;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NormalCell cell = null;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>boolean isParam = testFile.indexOf(“_arg”)&gt;1;</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (; c &lt;= cols; c++) {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell = (NormalCell) rd.getCell(r, c);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>try {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (isHeader) {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setBackColor(-1445385);// background color</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setForeColor(-14655348);// foreground color</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setLBColor(-2235674);// left</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setLBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setRBColor(-2235674);// right</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setRBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setTBColor(-2235674);// top</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setTBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setBBColor(-2235674);// bottom</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setBBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setBold(true);// font’s bold property</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setHAlign(INormalCell.HALIGN_CENTER);// header</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// horizon align</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} else {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setBackColor(-1);// background color</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setForeColor(-14655348);// foreground color</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setLBColor(-2235674);// left</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setLBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setRBColor(-2235674);// right</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setRBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setTBColor(-2235674);// top</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setTBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setBBColor(-2235674);// bottom</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isParam)cell.setBBStyle(INormalCell.LINE_SOLID);</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell.setBold(false);// font’s bold property</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rd.setCell(r, c, cell);</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} catch (Exception e) {</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>e.printStackTrace();</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;"><span style="font-size: 12pt;">}</span></p> 
  <p class="MsoNormal" style="text-indent: 23.25pt; layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">其他辅助程序详见附件。</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><span style="font-size: 12pt;">2</span><span style="font-family: 宋体; font-size: 12pt;">、操作流程</span></p> 
  <p class="MsoNormal" style="layout-grid: 15.6pt none;"><strong></strong></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">首先运行程序，选择报表模板所在的路径，如图所示：</span></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><img src="/wp-content/uploads/2011/07/8a8e77cd-7103-4bd6-9392-f7052809222f.jpg" alt="" width="553" height="144" /></span></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">选择读取</span><span style="font-size: 12pt;">raq</span><span style="font-family: 宋体; font-size: 12pt;">模板，将读取</span><span style="font-size: 12pt;">directory path</span><span style="font-family: 宋体; font-size: 12pt;">的全部模板，如下图所示：</span></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-size: 12pt;"><img src="/wp-content/uploads/2011/07/d3a59292-79ac-469f-93a4-ac057d66fc6c.jpg" alt="" width="552" height="171" /></span></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">选择优化颜色按钮，实现对模板的批量样式修改。</span></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;">&nbsp;</p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><strong><span style="font-family: 宋体; font-size: 12pt;">结语</span></strong><strong></strong></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">优点：可以实现批量的样式修改。</span></p> 
  <p class="MsoListParagraph" style="text-indent: 0cm; layout-grid: 15.6pt none;"><span style="font-family: 宋体; font-size: 12pt;">缺点：需要深度掌握润乾的</span><span style="font-size: 12pt;">api</span><span style="font-family: 宋体; font-size: 12pt;">，对于批量修改的报表局限于共性的修改，比如：全局字体、全局字体颜色、全局背景色、表头样式、数据区样式等的修改比较方便。</span></p> 
  <p class="MsoNormal" style="text-indent: 21pt; layout-grid: 15.6pt none;">&nbsp;</p> 
  <p></p>  
 </body>
</html>