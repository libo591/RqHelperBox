<html>
 <head></head> 
 <body> 
  <p></p> 
  <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">根据参数条件来过滤报表或统计图的数据结果，是很常见的报表功能。假定参数查询条件是要求选择某一时间区间，或者选择某一数字区间的时候，我们可以直接为报表设置这样的查询面板，比如，让客户分别输入一个最小数字，一个最大数字，然后点击查询按钮，根据这两个参数值去过滤报表数据。</span></p> 
  <br /> 
  <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">针对这种应用场景，我们还可以有其他的方法来实现这样的查询面板功能，比如提供一个可拖拽的滑动条，让用户以拖动的方式来设置参数的最值区间。</span></p> 
  <br /> 
  <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">下面来介绍一个实例，即实现了这样的功能：用滑动块来设置报表参数的最大值和最小值，动态改变统计图的显示数据。</span></p> 
  <br /> 
  <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">一起先来看看最终的实现效果：</span></p> 
  <br /> 
  <p style="MARGIN-LEFT: 0pt" class="MsoNormal"><span><img alt="截图07.png" src="/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=231ab271-3908-4550-8fef-fb74ec1a9686" width="554" height="303" /></span></p> 
  <br /> 
  <p style="TEXT-INDENT: 21pt" class="MsoNormal">&nbsp;</p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">本例的具体实现中，我们用到了</span><span>Bs_Slider</span><span style="FONT-FAMILY: 宋体">这个</span><span>js</span><span style="FONT-FAMILY: 宋体">的滑动条控件。</span><span>Jsp</span><span style="FONT-FAMILY: 宋体">页面具体代码如下：</span></p> 
  <br /> 
  <br /> 
  <br /> 
  <br /> 
  <table style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; BORDER-COLLAPSE: collapse; BORDER-TOP: medium none; BORDER-RIGHT: medium none" class="MsoTableGrid" border="1" cellspacing="0" cellpadding="0"> 
   <tbody> 
    <tr> 
     <td style="BORDER-BOTTOM: black 1pt solid; BORDER-LEFT: black 1pt solid; PADDING-BOTTOM: 0cm; PADDING-LEFT: 5.4pt; WIDTH: 426.1pt; PADDING-RIGHT: 5.4pt; BORDER-TOP: black 1pt solid; BORDER-RIGHT: black 1pt solid; PADDING-TOP: 0cm" valign="top" width="568"><br /> <p class="MsoNormal"><span>&lt;%@ page contentType=”text/html;charset=gb2312″ %&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;%@ taglib uri=”/WEB-INF/runqianReport4.tld” prefix=”report”%&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;%request.setCharacterEncoding( “GBK” );%&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;html&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;HEAD&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;SCRIPT src=”LibCrossBrowser.js” type=text/javascript&gt;&lt;/SCRIPT&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;SCRIPT src=”EventHandler.js” type=text/javascript&gt;&lt;/SCRIPT&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;SCRIPT src=”Bs_FormUtil.lib.js”<span>&nbsp; </span>type=text/javascript&gt;&lt;/SCRIPT&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;SCRIPT src=”Bs_ColorUtil.lib.js” type=text/javascript&gt;&lt;/SCRIPT&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;SCRIPT src=”Bs_Slider.class.js” type=text/javascript&gt;&lt;/SCRIPT&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;SCRIPT type=text/javascript&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;!–</span></p><br /> <p class="MsoNormal"><span>//</span><span style="FONT-FAMILY: 宋体">初始化设置滑动条的最大值</span><span>30</span><span style="FONT-FAMILY: 宋体">，最小值</span><span>1</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>min = 1</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>max = 30</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;%</span></p><br /> <p class="MsoNormal"><span>//</span><span style="FONT-FAMILY: 宋体">获取报表的最大值，最小值参数</span><span>,</span><span style="FONT-FAMILY: 宋体">并把参数负值给报表</span></p><br /> <p class="MsoNormal"><span>String A = request.getParameter( “A” );</span></p><br /> <p class="MsoNormal"><span>String B = request.getParameter( “B” );</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>if(A ==null){A=”0″;}</span></p><br /> <p class="MsoNormal"><span>if(B ==null){B=”30″;}</span></p><br /> <p class="MsoNormal"><span>String result=”A=”+A+”;B=”+B;</span></p><br /> <p class="MsoNormal"><span>%&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>A = &lt;%=A%&gt;</span></p><br /> <p class="MsoNormal"><span>B = &lt;%=B%&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>function setMinMax( mi,<span>&nbsp; </span>ma)</span></p><br /> <p class="MsoNormal"><span>{</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span style="FONT-FAMILY: 宋体">给滑块设置最大值、最小值</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>min<span>&nbsp; </span>= mi;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>max = ma;</span></p><br /> <p class="MsoNormal"><span>}</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>function reload_report()</span></p><br /> <p class="MsoNormal"><span>{</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span style="FONT-FAMILY: 宋体">用新的最值刷新报表</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//alert( document.getElementById(‘slider1knob1′).value +’:’ + document.getElementById(‘slider1knob2′).value )</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Av =<span>&nbsp; </span>document.getElementById(‘slider1knob1′).value;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Bv =<span>&nbsp; </span>document.getElementById(‘slider1knob2′).value;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>document.location.href=”slider_demo.jsp?A=”+Av+”&amp;B=”+Bv;</span></p><br /> <p class="MsoNormal"><span>}</span></p><br /> <p class="MsoNormal"><span>function init() {</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span style="FONT-FAMILY: 宋体">初始化</span><span>Bs_Slider</span><span style="FONT-FAMILY: 宋体">滑动条控件</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>if (min==0)</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp; </span>min=1</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>if (max==0)</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp; </span>max=30</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3 = new Bs_Slider();</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.width<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 516;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.height<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 56;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.imgDir<span>&nbsp;&nbsp; </span>= ”;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.setBackgroundImage(‘background.gif’, ‘no-repeat’);</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.attachOnChange(bsSliderChange);</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.fieldName<span>&nbsp;&nbsp;&nbsp;&nbsp; </span>= ‘slider3_start’;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.minVal<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= min;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.maxVal<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= max;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.valueInterval = 1;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.valueDefault<span>&nbsp; </span>= A;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.setSliderIcon(‘slider.gif’, 13, 18);</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.useInputField = 3;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.styleValueFieldClass = ‘sliderInput’;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.useSecondKnob<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= true;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.preventValueCrossing = true;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.wheelAmount<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0; //disable mouse wheeling cause we have 2 knobs.</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.fieldName2<span>&nbsp;&nbsp;&nbsp;&nbsp; </span>= ‘slider3_end’;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.minVal2<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= min;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.maxVal2<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= max;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.valueInterval2 = 1;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.valueDefault2<span>&nbsp; </span>= B;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.setSliderIcon2(‘slider.gif’, 13, 18);</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.useInputField2 = 3;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.styleValueFieldClass2 = ‘sliderInput’;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.colorbar = new Object({type:’between’, color:’red’,offsetLeft:6, height:20, offsetTop:37 });</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>mySlider3.drawInto(‘sliderDiv3′);</span></p><br /> <p class="MsoNormal"><span>}</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>/**</span></p><br /> <p class="MsoNormal"><span>* @param object sliderObj</span></p><br /> <p class="MsoNormal"><span>* @param int val (the value)</span></p><br /> <p class="MsoNormal"><span>* @param int newPos</span></p><br /> <p class="MsoNormal"><span>* @param int knobNo</span></p><br /> <p class="MsoNormal"><span>*/</span></p><br /> <p class="MsoNormal"><span>//</span><span style="FONT-FAMILY: 宋体">滑动时，记录改变后的最大值最小值</span></p><br /> <p class="MsoNormal"><span>function bsSliderChange(sliderObj, val, newPos, knobNumber) { </span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>document.getElementById(‘slider1knob’+knobNumber).value = val;</span></p><br /> <p class="MsoNormal"><span>}</span></p><br /> <p class="MsoNormal"><span>// –&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;/SCRIPT&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;/head&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;body topmargin=0 leftmargin=0 rightmargin=0 bottomMargin=0 &gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;report:html </span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>name=”report1″ </span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>reportFileName=”activeButton.raq”</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>width=”-1″</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>params=”&lt;%=result%&gt;”</span></p><br /> <p class="MsoNormal"><span>/&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;DIV id=sliderDiv3 </span></p><br /> <p class="MsoNormal"><span>style=”BORDER-RIGHT: gray 1px solid; BORDER-TOP: gray 1px solid; BORDER-LEFT: gray 1px solid; WIDTH: 600px; BORDER-BOTTOM: gray 1px solid; HEIGHT: 62px”&gt;&lt;/DIV&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;table width=600&gt;&lt;tr&gt;&lt;td align=left&gt;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;SCRIPT type=text/javascript&gt;document.write(min); &lt;/script&gt;</span></p><br /> <p class="MsoNormal"><span><span>&nbsp;</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/td&gt;&lt;td align=center&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;INPUT<span>&nbsp;&nbsp; </span>id=slider1knob1 size=2 name=slider1knob11 value=&lt;%=A%&gt;&gt;<span>&nbsp;&nbsp; </span></span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;%</span></p><br /> <p class="MsoNormal"><span>if(request.getParameter( “A” ) ==null)</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>out.println(“&lt;SCRIPT type=text/javascript&gt;slider1knob11.value = min ; &lt;/script&gt;”);</span></p><br /> <p class="MsoNormal"><span>%&gt;</span><span style="FONT-FAMILY: 宋体">日</span><span>-&amp;nbsp;</span></p><br /> <p class="MsoNormal"><span>&lt;INPUT<span>&nbsp; </span>id=slider1knob2 size=2 name=slider1knob21<span>&nbsp; </span>value=&lt;%=B%&gt;&gt;</span><span style="FONT-FAMILY: 宋体">日</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;%</span></p><br /> <p class="MsoNormal"><span>if(request.getParameter( “A” ) ==null)</span></p><br /> <p class="MsoNormal"><span><span>&nbsp; </span>out.println(“&lt;SCRIPT type=text/javascript&gt;slider1knob21.value = max ; &lt;/script&gt;”);</span></p><br /> <p class="MsoNormal"><span>%&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;/td&gt;&lt;td align=right&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;SCRIPT type=text/javascript&gt;document.write(max); &lt;/script&gt;&lt;/td&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;/table&gt;</span></p><br /> <p class="MsoNormal">&nbsp;</p><br /> <p class="MsoNormal"><span>&lt;INPUT type = hidden<span>&nbsp; </span>id=slider1knob1 size=2 name=slider1knob1 value=&lt;%=A%&gt;&gt;&lt;BR&gt; </span></p><br /> <p class="MsoNormal"><span>&lt;INPUT<span>&nbsp; </span>type = hidden<span>&nbsp; </span>id=slider1knob2 size=2 name=slider1knob2<span>&nbsp; </span>value=&lt;%=B%&gt;&gt;&lt;BR&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;SCRIPT type=text/javascript&gt;init();&lt;/script&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;/body&gt;</span></p><br /> <p class="MsoNormal"><span>&lt;/html&gt;</span></p></td> 
    </tr> 
   </tbody> 
  </table> 
  <br /> 
  <p class="MsoNormal">&nbsp;</p> 
  <br /> 
  <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">另外，在</span><span>raq</span><span style="FONT-FAMILY: 宋体">中，我们还可以把报表数据的最大值，最小值的，传给</span><span>jsp</span><span style="FONT-FAMILY: 宋体">页面，让滑动条初始化时，可以根据数据，设定滑动标尺本身的边界值。例如：如果月份是</span><span>2</span><span style="FONT-FAMILY: 宋体">月份时，数据中最大日期是</span><span>28</span><span style="FONT-FAMILY: 宋体">（也可能是</span><span>29</span><span style="FONT-FAMILY: 宋体">），那么标尺的最大值边界显示为</span><span>28</span><span style="FONT-FAMILY: 宋体">。</span></p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">在报表中，设置一个隐藏单元格，并设置表达式为：</span></p> 
  <br /> 
  <p class="MsoNormal"><span>=” &lt;SCRIPT type=text/javascript&gt; setMinMax(“+ ds2.Select(min) + ” , ” + ds2.Select(max)+”) &lt;/script&gt;”</span></p> 
  <br /> 
  <p></p>  
 </body>
</html>