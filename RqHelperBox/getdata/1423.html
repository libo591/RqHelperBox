<html>
 <head></head> 
 <body> 
  <div class="entry"> 
   <p>在一个报表系统中，除了报表的展现、查询、导出、打印等常见需求之外，往往还会有需要定时自动计算报表并分发的需求，比如每月月底自动生成本月的月报并email至相关部门负责人处、数据量很大计算起来需要一定时间但又不是即时就需要的报表希望可以在服务器空闲时自动进行计算等等。</p> 
   <p>润乾报表针对此类需求，提供了专门的调度器模块，具有强有力的报表任务调度功能，可以实现定时、批量等报表自动处理和报表的自动分发。</p> 
   <p>调度器采用全B/S方案，管理设置完全在Web上进行，配置界面如下：</p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/07/13.png" alt="1.png" height="312" /></p> 
   <p><strong>任务管理与触发</strong></p> 
   <p>润乾报表调度器允许把多个同等条件触发的报表调度工作组合成一个任务。每个任务均有确定的时间触发条件，任务类型选择界面如下：</p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/07/23.png" alt="2.png" height="96" /></p> 
   <p>目前提供如下几种任务类型：</p> 
   <ul> 
    <li>单次任务，设定任务执行的年月日时分秒；</li> 
    <li>每年任务，设定任务执行周期的月日时分秒；</li> 
    <li>半年任务，设定任务执行周期的月日时分秒；</li> 
    <li>季度任务，设定任务执行周期的月日时分秒；</li> 
    <li>每月任务，设定任务执行周期的日时分秒；</li> 
    <li>每天任务，设定任务执行周期的时分秒；</li> 
    <li>分钟任务，设定任务执行周期的时分秒；</li> 
    <li>自定义任务：可由用户根据自已业务情况组合出更复杂的条件，如果每月的第二个星期二下午5点等。</li> 
   </ul> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/07/31.png" alt="3.png" height="290" /></p> 
   <p>还可以通过”是否活动”项来决定该任务是否需要启动，并且支持设置执行判断表达式。只有同时满足”是否活动”为”活动”状态、执行判断表达式返回true值（不填时默认为true）、到达所选任务类型的任务执行时间三个条件时才会执行该任务。</p> 
   <p><strong>参数循环</strong></p> 
   <p>报表运算可能有各种参数，需要设置相应的参数循环才能完成报表任务的运算调度工作（如计算某月每天的交易汇总、计算某省所有地区的业务统计表），润乾报表调度器提供如下的参数循环机制：</p> 
   <ul> 
    <li>参数存储于数据库中：按顺序依次遍历数据库中的每一条数据；</li> 
    <li>区间型参数集合：通过预定义遍历范围和步长依次遍历数据；</li> 
    <li>枚举型参数集合：遍历用户枚举出的参数；</li> 
    <li>自定义参数集合：按照用户定义的表达式选择需要遍历的参数。</li> 
   </ul> 
   <p>下图是参数配置界面：</p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/07/4.png" alt="4.png" height="101" /></p> 
   <p><strong>分发控制</strong></p> 
   <p>生成完的报表还需要完善的分发机制，润乾报表调度器可生成TEXT、HTML、Excel、PDF、RAT等多种运算结果（可组合），并可根据任务的分发设置决定生成结果的去向，计有：</p> 
   <ul> 
    <li>存入本地文件系统：将结果按规定的目录体系存入调度器所在的本地文件系统；</li> 
    <li>FTP：通用FTP协议将结果上载到指定服务器；</li> 
    <li>EMAIL：通过EMAIL将结果发送给指定EMAIL帐号，可让相关人通过邮件及时收到报表运算结果；</li> 
    <li>自定义：由程序员自行处理报表运算的结果。</li> 
   </ul> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/07/5.png" alt="5.png" height="239" />&nbsp;<br /> <span lang="EN-US"></span></p> 
  </div>  
 </body>
</html>