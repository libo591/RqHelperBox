<html>
 <head></head> 
 <body> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">问题</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">:</span></p> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">润乾报表自定义函数中，增加的过滤条件可以为某个单元格的值吗？</span></p> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">amountcount(${macro1},@createDate,e.MATERIAL_KIND_NO=b4),</span></p> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可是我在调试过程中</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">不认</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">b4,</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">因为</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">b4</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">是一列变化的值</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">不能写死</span> <span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">模板中怎么写</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,</span></p> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">能把它传到自定义函数中去</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">?</span></p> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">问题解决</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">:</span></p> 
  <p><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">1</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果你想连带扩展的单元格也传进去</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">应该写成</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">B4{}</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这种格式</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US"> 
    <o:p /></span></p> 
  <p><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">2</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在后端获取分为两个步骤</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">: 
    <o:p /></span></p> 
  <p><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">(1)</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">首先</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通过</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">function</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的内置对象</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,paramList</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">来获取参数</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,paramList</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">是一个</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">ArrayList</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">类型</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,</span><span lang="EN-US" style="FONT-SIZE: 12pt" xml:lang="EN-US"> 
    <o:p /></span></p> 
  <p><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">比如获取第一个参数</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">Expression param1 = ( Expression )this.paramList.get( 0 ); 
    <o:p /></span></p> 
  <p><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">(2)</span> <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">其次</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通过</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">Variant2</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">取参数的值</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">,</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">取出来是</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">Object</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">对象</span><span lang="EN-US" style="FONT-SIZE: 10pt" xml:lang="EN-US">.Object result1 = Variant2.getValue( param1.calculate() );</span></p> 
  <p><br /></p>  
 </body>
</html>