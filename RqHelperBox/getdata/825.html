<html>
 <head></head> 
 <body> 
  <div class="entry"> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span style="'Times New Roman';">问题出现的条件：报表在</span><span lang="EN-US"><span style="Times New Roman;">WEB</span></span><span style="'Times New Roman';">页面输出的时候，行、列都很多，需要设置横向、纵向滚动条来固定报表表头。但是，由于报表输出的标签中指定的滚动条的宽度、高度都是一个指定的高度、宽度，而不能设置为一个按页面宽度高度的百分比。</span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span style="'Times New Roman';"><span style="small;"><span style="x-small;"><span style="xx-small;">例如：</span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;report:html name=”report1″ reportFileName=”&lt;%=raqpath%&gt;”</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>…</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>needScroll=”yes”</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>scrollWidth=”<strong><span style="blue;">300</span></strong>“</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>scrollHeight=”<strong><span style="blue;">200</span></strong>“</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>…</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/&gt;</span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="'Times New Roman';"><span style="small;"><span style="x-small;"><span style="xx-small;">这样，就造成针对客户端不同的分辨率的显示器，滚动条的高度和宽度固定，对于分辨率小的机器，在页面上看不到滚动条，分辨率大的机器，滚动条右下方留出了很大的空白，这样造成页面不美观，影响用户体验。</span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="'Times New Roman';"><span style="small;"><span style="x-small;"><span style="xx-small;">因此，针对以上问题，结合项目经验，这里，抛砖引玉，提出一个简便易行的解决方法。</span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;">&nbsp;</span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span lang="EN-US"><span style="Times New Roman;">1.</span></span><span style="'Times New Roman';">在客户访问一个报表页面之前，加一个</span><span lang="EN-US"><span style="Times New Roman;">redirect.jsp</span></span><span style="'Times New Roman';">页面，里面加入一个</span><span lang="EN-US"><span style="Times New Roman;">js</span></span><span style="'Times New Roman';">函数，来获取客户端浏览器窗口的大小：</span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span style="DA;" lang="DA"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;">&lt;SCRIPT&gt;</span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="DA;" lang="DA"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp; </span>var w = 0;<span style="yes;">&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="DA;" lang="DA"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>var h = 0;<span style="yes;">&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span style="Times New Roman;"><span style="DA;" lang="DA"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US">//</span></span><span style="'Times New Roman';">通过深入</span><span lang="EN-US"><span style="Times New Roman;">Document</span></span><span style="'Times New Roman';">内部对</span><span lang="EN-US"><span style="Times New Roman;">body</span></span><span style="'Times New Roman';">进行检测，获取浏览器窗口大小</span><span lang="EN-US"><span style="yes;"><span style="Times New Roman;">&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="blue;"><span style="yes;">&nbsp;&nbsp;</span>if (document.documentElement<span style="yes;"></span>&amp;&amp; document.documentElement.clientHeight &amp;&amp; document.documentElement.clientWidth){<span style="yes;">&nbsp;&nbsp; </span></span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="blue;" lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>h = document.documentElement.clientHeight;<span style="yes;">&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span style="blue;" lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="yes;">&nbsp;&nbsp;&nbsp;</span>w = document.documentElement.clientWidth;<span style="yes;">&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}else{</span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp; </span>w = 1259 ;</span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp; </span>h = 632 ;</span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<span style="yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt 63pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span lang="EN-US"><span style="Times New Roman;">//</span></span><span style="'Times New Roman';">重定向到报表所在的</span><span lang="EN-US"><span style="Times New Roman;">jsp</span></span><span style="'Times New Roman';">页面，并且把客户端浏览器宽度、高度，作为参数</span></span></span></span></p> 
   <p class="MsoNormal" style="center 239.15pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span lang="EN-US"><span style="Times New Roman;">//</span></span><span style="'Times New Roman';">传递给报表所在的</span><span lang="EN-US"><span style="Times New Roman;">jsp</span></span><span style="'Times New Roman';">页面</span><span lang="EN-US"><span style="1;"><span style="Times New Roman;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="blue;">window.location.href=”&lt;%=path%&gt;/mis2/reportcenter/res/showReport.jsp?&lt;%=param%&gt;&amp;w=”+w+”&amp;h=”+h ;</span></span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="yes;">&nbsp;</span>&lt;/SCRIPT&gt;</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="1;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></span></span></p> 
   <p class="MsoNormal" style="2.0;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span lang="EN-US"><span style="Times New Roman;">2.</span></span><span style="'Times New Roman';">在报表所在的</span><span lang="EN-US"><span style="Times New Roman;">jsp</span></span><span style="'Times New Roman';">页面上（</span><span lang="EN-US"><span style="Times New Roman;">showReport.jsp</span></span><span style="'Times New Roman';">），获取浏览器的宽度、高度</span></span></span></span></p> 
   <p class="MsoNormal" style="21pt;"><span lang="EN-US"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;">String w = request.getParameter(”w”) ;</span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String h= request.getParameter(”h”) ;</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="1;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span lang="EN-US"><span style="Times New Roman;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>3.</span></span><span style="'Times New Roman';">在报表输出的标签中，</span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;report:html name=”report1″ reportFileName=”a.raq”</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>funcBarLocation=””</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>params=”&lt;%=param.toString()%&gt;”</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>needScroll=”yes”</span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span style="small;"><span style="x-small;"><span style="xx-small;"><span lang="EN-US"><span style="Times New Roman;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>scrollWidth=”&lt;%=w%&gt;” –</span></span><span style="'Times New Roman';">动态设置滚动条宽度、高度</span></span></span></span></p> 
   <p class="MsoNormal" style="21.0pt 42.0pt 63.0pt 84.0pt 105.0pt 126.0pt 147.0pt 168.0pt 207.75pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>scrollHeight=”&lt;%=h%&gt;” </span></span></span></span></span></p> 
   <p class="MsoNormal" style="0cm 0cm 0pt;"><span lang="EN-US"><span style="small;"><span style="Times New Roman;"><span style="x-small;"><span style="xx-small;"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/&gt;</span></span></span></span></span></p> 
   <p><span style="AR-SA;" lang="EN-US"><span style="1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="'Times New Roman';">完成！呵呵，是不是很简单。这样，我们就能自动根据客户端浏览器窗口大小，自动设置固定表头报表的滚动条高度、宽度，使用户体验大大提升。<br /> </span></p> 
   <p><span lang="EN-US"></span></p> 
  </div>  
 </body>
</html>