<html>
 <head></head> 
 <body> 
  <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">业务场景：</span></strong></p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">利用润乾报表的</span><span>API</span><span style="FONT-FAMILY: 宋体">可以方便实现导入</span><span>excel</span><span style="FONT-FAMILY: 宋体">中的数据提交入库，通常可以分为两种，普通报表和行式报表，普通报表即报表格式固定，报表中的数据格式无规律。行式报表通常不定行数据的提交。但我们可能会遇到这种情况，如下图所示：</span></p> 
  <p class="MsoNormal"><span><img src="http://www.runqian.com.cn/wp-content/uploads/2012/07/zrclip_002p20205aa0.png" height="166" width="566" /></span></p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">其中，编制单位以及金额单位需要提交数据入库，并且第</span><span>6,7</span><span style="FONT-FAMILY: 宋体">行是不固定的，即是不定行的。</span></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">处理思路：</span></strong></p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">对于这种报表，单纯用普通报表的导入提交或者是行式报表的导入提交都是不行的。可以用如下的思路来解决：</span></p> 
  <p class="MsoNormal"><span>1</span><span style="FONT-FAMILY: 宋体">：报表还是设置成普通报表，否则编制单位以及金额单位提交不了</span></p> 
  <p class="MsoNormal"><span>2</span><span style="FONT-FAMILY: 宋体">：获取到导入</span><span>excel</span><span style="FONT-FAMILY: 宋体">的数据行后，生成</span><span>to(1,N)</span><span style="FONT-FAMILY: 宋体">的表达式，用于扩展出不定行。</span></p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">利用这个方法，既可以变相解决不定行的问题。</span></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">相关代码：</span></strong></p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">生成</span><span>to</span><span style="FONT-FAMILY: 宋体">函数并写到单元格表达式：</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">private</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">IReport calcReport(String reportFile)</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">throws</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Exception {</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">ReportDefine rd = (ReportDefine) ReportUtils.<em>read</em>(reportFile);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">cxt</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">=</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Context();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Connection connection =</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">null</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">;</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">try</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">{</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Driver driver = (Driver) Class.<em>forName</em>(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“com.newatlanta.jturbo.driver.Driver”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">)</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.newInstance();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">DriverManager.<em>registerDriver</em>(driver);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">connection = DriverManager.<em>getConnection</em>(</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“jdbc:JTurbo://localhost/runqian/charset=GBK”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“sa”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“sa”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">catch</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">(Exception e) {</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">e.printStackTrace();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">//</span> <span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">设置数据源</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">,</span><span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">动态改变连接参数</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">cxt</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.setDefDataSourceName(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“jdbc/defualt”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">//</span> <span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">设置数据连接</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">,</span><span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">也可以设置连接池工厂</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">,</span><span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">如</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">cxt.setConnectionFactory(sourceName,connectionFactory)</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">//</span> <span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">其中</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">connectionFactory</span><span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">这个类必须</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">implements IConnectionFactory,</span><span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">并且实现他的</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">public</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">// java.sql.Connection getConnection() throws Exception</span> <span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">方法</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">cxt</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.setConnection(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“jdbc/defualt”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">, connection);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">DataSourceConfig dsoc =</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">DataSourceConfig(2,</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">true</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“GBK”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“GBK”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">false</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">cxt</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.setDataSourceConfig(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“jdbc/defualt”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">, dsoc);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">int</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">excelcount=</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">excelReport</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.getRowCount()-1;</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">INormalCell a2=rd.getCell(2, (</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">short</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">)1);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">IByteMap a2map=</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">ByteMap();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">String value=</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“to(1,”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">+excelcount+</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“)”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">;</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">a2map.put(INormalCell.</span><em><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">VALUE</span></em><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,value);</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">//</span><span style="FONT-FAMILY: 宋体; COLOR: #3f7f5f; FONT-SIZE: 10pt">设置单元格的数据值表达式</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">a2.setExpMap(a2map); </span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">rd.setCell(2, (</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">short</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">)1, a2);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Engine engine =</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Engine(rd,</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">cxt</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">IReport iReport = engine.calc();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">return</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">iReport;</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 宋体">提交入库的代码</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">public</span></strong> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">void</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">saveFromExcel(String reportFile, String excelFile,</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">int</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">sheetNum)</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">throws</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">Exception {</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">ArrayList &lt;IReport&gt;al=</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">ArrayList&lt;IReport&gt;(sheetNum);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">al=excelToReport( excelFile,sheetNum);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">for</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">(</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">int</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">s=0;s&lt;al.size();s++){</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">excelReport</span> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">= al.get(s);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">IReport report = calcReport(reportFile);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">System.</span><em><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">out</span></em><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.println(report);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">System.</span><em><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">out</span></em><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.println(al.size());</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">System.</span><em><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">out</span></em><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.println(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 宋体; COLOR: #2a00ff; FONT-SIZE: 10pt">有效行：</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">===”</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">+getExcelReportCount(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">excelReport</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">));</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">for</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">(</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">int</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">i=2;i&lt;=getExcelReportCount(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">excelReport</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">);i++){</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: #3f7f5f; FONT-SIZE: 10pt">//</span> for(int i=1;i&lt;=excelReport.getRowCount();i++){</p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">for</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">(</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">int</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">j=1;j&lt;</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">excelReport</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.getColCount();j++){</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">INormalCell iCell=report.getCell(i, (</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">short</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">)(j+1));</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">INormalCell iExcelCell=</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">excelReport</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.getCell(i, (</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">short</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">)j);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">System.</span><em><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">out</span></em><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">.println(</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 宋体; COLOR: #2a00ff; FONT-SIZE: 10pt">第</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">+i+</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 宋体; COLOR: #2a00ff; FONT-SIZE: 10pt">行；第</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">+j+</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 宋体; COLOR: #2a00ff; FONT-SIZE: 10pt">列：数据为：</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #2a00ff; FONT-SIZE: 10pt">“</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">+iExcelCell.getValue());</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">if</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">(iCell.getInputProperty()!=</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">null</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">){</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">iCell.getInputProperty().setInputValue(iExcelCell.getValue());</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">else</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">{</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">InputProperty ip =</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">InputProperty();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">ip.setInputValue(iExcelCell.getValue());</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">iCell.setInputProperty( ip );</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"> </p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">DataSaver dsave =</span> <strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">new</span></strong> <span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">DataSaver((ExtCellSet)report,</span><strong><span style="FONT-FAMILY: 'Courier New'; COLOR: #7f0055; FONT-SIZE: 10pt">null</span></strong><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">,</span><span style="FONT-FAMILY: 'Courier New'; COLOR: #0000c0; FONT-SIZE: 10pt">cxt</span><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">);</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">dsave.save();</span></p> 
  <p style="TEXT-ALIGN: left" class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p class="MsoNormal"><span style="FONT-FAMILY: 'Courier New'; COLOR: black; FONT-SIZE: 10pt">}</span></p> 
  <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体; COLOR: black; FONT-SIZE: 10pt">总结：</span></strong></p> 
  <p><span style="FONT-FAMILY: 宋体; COLOR: black; FONT-SIZE: 10pt">有些时候，单纯用普通报表或者行式报表都难以达到业务需求，这时候可能就需要变通一下。通过润乾的二次开发接口已经已有的一些函数可方便完成这种功能</span></p>  
 </body>
</html>