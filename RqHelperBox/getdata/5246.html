<html>
 <head></head> 
 <body> 
  <div style="LAYOUT-GRID: 15.6pt none" class="Section1"> 
   <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">问题场景</span></strong><span style="FONT-FAMILY: 宋体">：</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">在润乾填报过程中，常常会涉及到从一个系统中导出</span><span>Excel</span><span style="FONT-FAMILY: 宋体">数据文件，然后再将导出的</span><span>Excel</span><span style="FONT-FAMILY: 宋体">数据文件通过导入</span><span>Excel</span><span style="FONT-FAMILY: 宋体">填报的方式，将数据保存其他的系统数据库中。这时，如果导出的</span><span>Excel</span><span style="FONT-FAMILY: 宋体">的报表中含有日期时间型数据，那么再导入</span><span>Excel</span><span style="FONT-FAMILY: 宋体">到页面的时候，</span><span>Excel</span><span style="FONT-FAMILY: 宋体">中原本包含的日期时间数据中的时间将会出现丢失的问题。</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"> </p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">报表情况：</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span><img src="http://www.runqian.com.cn/wp-content/uploads/2012/06/zrclip_010n4dffd73d.png" height="254" width="559" /></span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">导出</span><span>Excel</span><span style="FONT-FAMILY: 宋体">情况</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span><img src="http://www.runqian.com.cn/wp-content/uploads/2012/06/zrclip_009p64a9c293.png" height="226" width="565" /></span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">导入</span><span>Excel</span><span style="FONT-FAMILY: 宋体">填报页面情况</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span><img src="http://www.runqian.com.cn/wp-content/uploads/2012/06/zrclip_008n1e2285c0.png" height="238" width="557" /></span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">从导入的结果看，所有日期时间型数据中包含的时间在导入页面之后已经丢失了。</span></p> 
   <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">原因分析：</span></strong></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">通过对导出的</span><span>Excel</span><span style="FONT-FAMILY: 宋体">中的日期时间型数据所在单元格的单元格格式进行查看，发现非字符串类型数据都是作为</span><span>Excel</span><span style="FONT-FAMILY: 宋体">自定义的格式进行导出的，字符串类型数据都是作为文本方式导出。这样再将导出的</span><span>Excel</span><span style="FONT-FAMILY: 宋体">再进行导入填报页面的时候就造成了格式的不匹配，从而造成了时间的丢失。</span></p> 
   <p class="MsoNormal"> </p> 
   <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">解决方法：</span></strong></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">将导出</span><span>Excel</span><span style="FONT-FAMILY: 宋体">的报表模板中的时间日期型数据转化为字符串，这样在导出</span><span>Excel</span><span style="FONT-FAMILY: 宋体">的时候，数据会作为文本格式进行导出，在导出的</span><span>Excel</span><span style="FONT-FAMILY: 宋体">中单元格格式也是文本格式，所以再将</span><span>Excel</span><span style="FONT-FAMILY: 宋体">导入到报表页面进行填报的时候就可以正常数据导入了。</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">报表修改方法：</span></p> 
   <p style="TEXT-INDENT: 21pt" class="MsoNormal"><span><img src="http://192.168.0.63:83/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=599b0e23-8e5f-4c83-9215-1e9ec1afe11f" height="78" width="554" /></span></p> 
   <p class="MsoNormal"> </p> 
   <p class="MsoNormal"><strong><span style="FONT-FAMILY: 宋体">总结：</span></strong></p> 
   <p style="TEXT-INDENT: 20.6pt" class="MsoNormal"><span style="FONT-FAMILY: 宋体">上述日期时间型数据只是一个示例，其他的数据类型数据导出</span><span>Excel</span><span style="FONT-FAMILY: 宋体">，然后再导入</span><span>Excel</span><span style="FONT-FAMILY: 宋体">到填报页面时，也会涉及到丢失精度等问题，在这种情况下，我们可以将报表的数据全部转为字符串类型进行处理。</span></p> 
   <p></p> 
  </div>  
 </body>
</html>