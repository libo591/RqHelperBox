<html>
 <head></head> 
 <body> 
  <p></p> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><b><span style=" ">需求分析</span></b></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><b><span style=" "></span></b>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">随着用户报表需求的多样化<span>,</span>简单的报表样式很难满足繁多的需求。如，一张报表上面是网格报表下面是分栏报表。分析知道，通过报表系统可以使用主子表的方式，把网格报表放到子表中，但是需求里的分栏报表又不是简简单单的分栏，里面包含了多层的分组表头。如下图所示。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "><br /><img style="WIDTH: 467px; HEIGHT: 274px" border="0" src="an.com.cn/wp-content/uploads/2011/07/df105ee4-091c-4d82-aac1-a624fea3f294.png" width="616" height="407" /><br />所以在分组报表这块使用了行属性中的“分组表头”来实现多表头的分栏报表。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">不过由于报表中的行类型的界别限制，在表头区域上面的行无法设成数据区，所以用了标题区来代替。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "><img style="WIDTH: 372px; HEIGHT: 244px" border="0" src="an.com.cn/wp-content/uploads/2011/07/44fa1e3c-9b25-40f2-97fd-fa240b007e23.png" width="497" height="324" /><br />可是新的问题也随之产生，对于子表中的数据量如果过多，标题区是无法分页的，导致整套的报表不能分页显示。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">之前的实现思路是将一张报表拆分成两张，然后通过<span>PageBuilder</span>将两表中每一页都拆分成多个<span>rat</span>，再将第一张表的最后一页对应到第二张表的第一页前的空白行中，写入数据，这种方式可以很好的实现这种复杂功能。优点在于两张表的行高可以随意设置，不需要互相对应，代码量比较简单。缺点在于，分页导出等功能需要另外实现。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">经过思考以及用户对导出分页等功能的需求，研究了以下替代方式，原理是通过<span>api</span>提前创建出一张空白的<span>raq</span>（注意：是<span>raq</span>），还是先将第一张表的最后页数据写入第二张表的开始，再通过<span>PageBuilder</span>将每一页拆分成多个<span>rat</span>，读取全部的行数，为之前创建的<span>raq</span>增加空白行，再遍历每张<span>rat</span>的单元格，将其属性写入到<span>raq</span>中，由于<span>rat</span>到<span>raq</span>的单元格写入有局限性，无法直接将<span>INormalCell</span>直接赋值到<span>raq</span>中，所以需要取得属性后，将属性赋值到<span>raq</span>中。并且对于合并单元格的赋值也需要利用到<span>api</span>动态合并单元格的功能。最后得到一个<span>ReportDefine</span>的结果报表对<span style="COLOR: black">象，通过</span></span><span style=" COLOR: black; ">defineBean</span><span style=" COLOR: black; ">的形式通过标签来展现报表，分页导出等功能自然就能实现了，此方法优点在于用户体验度比较理性具有和以往报表页面中的操作功能，具有一定的通用性，缺点在于，报表的单元格高度需要强制要求，否则写入</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">后的分页样式会不同，代码量也比较大。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><b><span style=" ">实现步骤</span></b><span style=" ">&nbsp;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span><b></b>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">1</span><span style=" ">，首先根据传入的报表列数创建一张空白的报表</span><span style=" ">raq</span><span style=" ">（也就是</span><span style=" COLOR: black; ">ReportDefine</span><span style=" COLOR: black; ">，这里也可以创建计算好的报表</span><span style=" COLOR: black; ">rat</span><span style=" COLOR: black; ">，但是考虑到最后要使用标签形式读取，随意采用的写入</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">中的方案</span><span style=" ">）</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; TEXT-INDENT: 21pt; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">ReportDefine rdStatic = </span><b><span style=" COLOR: #7f0055; ">new</span></b><span style=" COLOR: black; "> ReportDefine2(1, col);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; //</span><span style=" COLOR: black; ">获取需要对该</span><span style=" COLOR: black; ">ReportDefine</span><span style=" COLOR: black; ">对象增加多少空白行，计算行数是通过计算两张报表的总和</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; rdStatic.addRow(allAddRow(report_sub, report));</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">2</span><span style=" ">，创建好了</span><span style=" COLOR: black; ">N</span><span style=" COLOR: black; ">多空行的</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">后，下面要做的就是将两张报表拆分整理写入这个</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">中。首先是第一张报表（除最后一页）</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; 1</span><span style=" COLOR: black; ">）计算子报表，也就是需求中上面的网格式报表（由于子表最后一页的数据要写入第二张表的前面，所以这一步无需计算最后一页的数据）</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">计算子表（只计算整页数的）</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IReport ireport_sub = toReport(report_sub);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> pagecount_sub = allPage(ireport_sub);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; TEXT-INDENT: 21pt; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">2</span><span style=" COLOR: black; ">）通过</span><span style=" ">PageBuilder</span><span style=" ">按页进行拆分，然后逐页逐行的写入之前创建好的<span>raq</span>中。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: red">*</span></span><span style=" COLOR: black; "> setICell ()</span><span style=" COLOR: black; ">这个方法是将</span><span style=" COLOR: black; ">rat</span><span style=" COLOR: black; ">单元格属性写入到</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">中，在后面会介绍。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">对子表进行按页拆分</span><span style=" COLOR: #3f7f5f; ">(</span><span style=" COLOR: #3f7f5f; ">除了最后一页</span><span style=" COLOR: #3f7f5f; ">)</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> page = 1; page &lt; pagecount_sub; page++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IReport ir = </span><span style=" COLOR: #0000c0; ">pb</span><span style=" COLOR: black; ">.getPage(page);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ir.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> j = 1; j &lt;= ir.getColCount(); j++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell iCell = ir.getCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell inc = rdStatic.getCell((i + (page – 1)</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ir.getRowCount()), (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setICell(iCell, inc);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">3</span><span style=" ">，写入第一张报表的最后一页，以及第二张报表第一页</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">&nbsp;&nbsp;&nbsp; 1</span><span style=" ">）获取第一张表最后一页行数，然后再第二张报表第一行前插入相应行数并且设置行类别</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">获取子表最后一页，在主表中增加相应行数，将数据写入</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IReport ir_sub_end = </span><span style=" COLOR: #0000c0; ">pb</span><span style=" COLOR: black; ">.getPage(pagecount_sub);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ir_sub_end.getRowCount();</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">将主表中增加取得的行数并设置行属性为标题</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReportDefine rd = (ReportDefine) ReportUtils.<i>read</i>(report);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rd.insertRow(1, ir_sub_end.getRowCount());</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ir_sub_end.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IRowCell rowcell = rd.getRowCell(i); </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">根据行号获得行首格</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowcell.setRowType(IRowCell.</span><i><span style=" COLOR: #0000c0; ">TYPE_TITLE_HEADER</span></i><span style=" COLOR: black; ">);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; 2</span><span style=" COLOR: black; ">）将第一张表最后页数据写入第二张表之前插入的空行内。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IReport iReport = toReport(rd);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">将数据写入主表空白单元格内</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #0000c0; ">pb</span><span style=" COLOR: black; "> = </span><b><span style=" COLOR: #7f0055; ">new</span></b><span style=" COLOR: black; "> PageBuilder(iReport);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IReport ir_begin = </span><span style=" COLOR: #0000c0; ">pb</span><span style=" COLOR: black; ">.getPage(1);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ir_begin.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IRowCell rowcell = ir_begin.getRowCell(i);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowcell.setRowType(IRowCell.</span><i><span style=" COLOR: #0000c0; ">TYPE_NORMAL</span></i><span style=" COLOR: black; ">);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ir_sub_end.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> j = 1; j &lt;= ir_sub_end.getColCount(); j++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell iCell = ir_sub_end.getCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ir_begin.setCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j, iCell);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" ">&nbsp;&nbsp;&nbsp; 3</span><span style=" ">）这样第一张表的最后一页再加上第二张表的前面一段数据就合成了</span><span style=" ">一</span><span style=" ">整页的效果，一起写入到</span><span style=" ">raq</span><span style=" ">中。由于之前已经写入了一部分内容，所以循环写入的位置需要重新计算下。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">将填好数据的主表第一页写入最终的</span><span style=" COLOR: #3f7f5f; ">ireport</span><span style=" COLOR: #3f7f5f; ">中</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ir_begin.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> j = 1; j &lt;= ir_begin.getColCount(); j++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell iCell = ir_begin.getCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell inc = rdStatic.getCell(i</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + ireport_sub.getRowCount() – ir_sub_end.getRowCount(),</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setICell(iCell, inc);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">3</span><span style=" COLOR: black; ">，将第二张表剩下的部分写入到</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">的最后面，同样是需要计算下循环写入的位置。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">将主表中后几页写入最终的</span><span style=" COLOR: #3f7f5f; ">ireport</span><span style=" COLOR: #3f7f5f; ">中</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> page_i = </span><span style=" COLOR: #0000c0; ">pb</span><span style=" COLOR: black; ">.getPage(2).getRowCount();</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> page = 2; page &lt;= allPage(iReport); page++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IReport ir = </span><span style=" COLOR: #0000c0; ">pb</span><span style=" COLOR: black; ">.getPage(page);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ir.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> j = 1; j &lt;= ir.getColCount(); j++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell iCell = ir.getCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i1 = (ireport_sub.getRowCount()</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; – ir_sub_end.getRowCount() + ir_begin.getRowCount())</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + (page – 2) * page_i;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell inc = rdStatic.getCell(i + i1, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setICell(iCell, inc);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">4</span><span style=" COLOR: black; ">，由于</span><span style=" COLOR: black; ">rat</span><span style=" COLOR: black; ">和</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">间有着一些微妙的区别，有些属性是无法复制过去的，例如合并单元格。所以采用了对报表本身增加标识，然后通过动态合并单元格的方法。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: black; ">在报表中对合并单元格的数据前增加标识“</span><span style=" COLOR: black; ">#</span><span style=" COLOR: black; ">”</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "><img alt="说明: http://192.168.0.63/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=a6a7e747-70d9-4cd7-932d-a5f1c4780cdc" src="an.com.cn/wp-content/uploads/2011/07/237e0ed4-ab4e-478c-89ce-fd36738cfae5.jpg" width="479" height="100" /></span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; "><img style="WIDTH: 322px; HEIGHT: 127px" border="0" src="an.com.cn/wp-content/uploads/2011/07/392390cf-f207-4023-83ca-0d2970155d7c.png" width="393" height="168" /><br />&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">计算最终报表，去掉合并单元格标识</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; TEXT-INDENT: 21pt; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: #3f7f5f; ">//</span><span style=" COLOR: #3f7f5f; ">进行有标识的单元格合并</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">public</span></b><span style=" COLOR: black; "> </span><b><span style=" COLOR: #7f0055; ">static</span></b><span style=" COLOR: black; "> </span><b><span style=" COLOR: #7f0055; ">void</span></b><span style=" COLOR: black; "> mergeReport(ReportDefine ireportStatic) </span><b><span style=" COLOR: #7f0055; ">throws</span></b><span style=" COLOR: black; "> Exception {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String dealFlag = </span><span style=" COLOR: #2a00ff; ">“#”</span><span style=" COLOR: black; ">;</span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">报表中对数据进行了标识，为了是后面进行单元格合并时的判断标志</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = ireportStatic.getRowCount(); i &gt;= 1; i–) {</span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">遍历</span><span style=" COLOR: #3f7f5f; ">rat</span><span style=" COLOR: #3f7f5f; ">的行列</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> j = ireportStatic.getColCount(); j &gt;= 1; j–) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell cell0 = ireportStatic.getCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">逐行逐列取得单元格</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">byte</span></b><span style=" COLOR: black; "> extMode = cell0.getExtendMode();</span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">获取扩展区域</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">if</span></b><span style=" COLOR: black; "> (j != 1 &amp;&amp; cell0.getValue() != </span><b><span style=" COLOR: #7f0055; ">null</span></b><span style=" COLOR: black; ">) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">if</span></b><span style=" COLOR: black; "> (cell0.getValue().toString().indexOf(dealFlag) &gt;= 0) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell cell1 = ireportStatic.getCell(i,</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) (j – 1));</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> mAreaDStartCol, mAreaDEndCol, mAreaUStartCol, mAreaUEndCol;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mAreaDStartCol = cell0.isMerged() ? cell0</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .getMergedArea().getBeginCol() : j;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mAreaDEndCol = cell0.isMerged() ? cell0.getMergedArea()</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .getEndCol() : j;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mAreaUStartCol = cell1.isMerged() ? cell1</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .getMergedArea().getBeginCol()</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : mAreaDStartCol – 1;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mAreaUEndCol = cell1.isMerged() ? cell1.getMergedArea()</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .getEndCol() : mAreaDEndCol – 1;</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">if</span></b><span style=" COLOR: black; "> (cell1.getValue() != </span><b><span style=" COLOR: #7f0055; ">null</span></b></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; cell1.getValue().equals(cell0.getValue())) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cell1.setValue(cell0.getValue());</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Area area = </span><b><span style=" COLOR: #7f0055; ">new</span></b><span style=" COLOR: black; "> Area(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) mAreaUStartCol, i,</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) mAreaDEndCol);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReportUtils.<i>mergeReport</i>(ireportStatic, area);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">if</span></b><span style=" COLOR: black; "> (cell0.getValue().equals(dealFlag)) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Area area = </span><b><span style=" COLOR: #7f0055; ">new</span></b><span style=" COLOR: black; "> Area(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) mAreaUStartCol, i,</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) mAreaDEndCol);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReportUtils.<i>mergeReport</i>(ireportStatic, area);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">将没有用到的单元格中的标识</span><span style=" COLOR: #3f7f5f; ">#</span><span style=" COLOR: #3f7f5f; ">去掉</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> i = 1; i &lt;= ireportStatic.getRowCount(); i++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">for</span></b><span style=" COLOR: black; "> (</span><b><span style=" COLOR: #7f0055; ">int</span></b><span style=" COLOR: black; "> j = 1; j &lt;= ireportStatic.getColCount(); j++) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INormalCell cell2 = ireportStatic.getCell(i, (</span><b><span style=" COLOR: #7f0055; ">short</span></b><span style=" COLOR: black; ">) j);</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">if</span></b><span style=" COLOR: black; "> (cell2.getValue() != </span><b><span style=" COLOR: #7f0055; ">null</span></b></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; cell2.getValue().toString().indexOf(dealFlag) &gt;= 0) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cell2.setValue(cell2.getValue().toString().replace(</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dealFlag, </span><span style=" COLOR: #2a00ff; ">“”</span><span style=" COLOR: black; ">));</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">5</span><span style=" COLOR: black; ">，最后在</span><span style=" COLOR: black; ">jsp</span><span style=" COLOR: black; ">页面中直接调用此方法获取到最终的</span><span style=" COLOR: black; ">reportDefine</span><span style=" COLOR: black; ">，通过</span><span style=" COLOR: black; ">defineBean</span><span style=" COLOR: black; ">的方式展现即可。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">request.setAttribute(reportDefine, mr.apiToReport(</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #2a00ff; ">“D://pp_sub.raq”</span><span style=" COLOR: black; "></span><span style=" COLOR: #2a00ff; ">“D://pp.raq”</span><span style=" COLOR: black; ">, 8));</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: teal; ">&lt;</span><span style=" COLOR: #3f7f7f; ">report:html </span><span style=" COLOR: #7f007f; ">name</span><span style=" COLOR: black; ">=</span><span style=" COLOR: #2a00ff; ">“report1″ </span><span style=" COLOR: #7f007f; ">srcType</span><span style=" COLOR: black; ">=</span><span style=" COLOR: #2a00ff; ">“defineBean”</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: #2a00ff; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=" COLOR: #7f007f; ">beanName</span><span style=" COLOR: black; ">=</span><span style=" COLOR: #2a00ff; ">“</span><span style=" COLOR: #bf5f3f; ">&lt;%=</span><span style=" ">r<span style="COLOR: black">eportDefine</span><span style="COLOR: #bf5f3f">%&gt;</span>“<span style="COLOR: black"> </span><span style="COLOR: teal">/&gt;</span></span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">页面效果如下：</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; "></span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; "><img style="WIDTH: 391px; HEIGHT: 459px" border="0" src="an.com.cn/wp-content/uploads/2011/07/f4b59f39-a78a-488b-b0e2-4780782b2eee.png" width="634" height="683" /><br />附</span><span style=" COLOR: black; ">1</span><span style=" COLOR: black; ">：文中采用的方法是将</span><span style=" COLOR: black; ">rat</span><span style=" COLOR: black; ">的数据写入到</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">中，在操作过程中发现了一些问题。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">虽然</span><span style=" COLOR: black; ">reportDefine</span><span style=" COLOR: black; ">（</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">）实现了</span><span style=" COLOR: black; ">IReport</span><span style=" COLOR: black; ">（</span><span style=" COLOR: black; ">rat</span><span style=" COLOR: black; ">）接口，它俩的方法也都是完全一样，可是在将</span><span style=" COLOR: black; ">rat</span><span style=" COLOR: black; ">的单元格写入到</span><span style=" COLOR: black; ">raq</span><span style=" COLOR: black; ">中，原本认为直接通过</span><span style=" COLOR: black; ">set</span><span style=" COLOR: black; ">、</span><span style=" COLOR: black; ">get</span><span style=" COLOR: black; ">方法将</span><span style=" COLOR: black; ">INormalCell</span><span style=" COLOR: black; ">赋值过去即可，却无法达到预期效果，后台报错，所以采取了逐个赋值</span><span style=" COLOR: black; ">INormalCell</span><span style=" COLOR: black; ">中的属性的方法，方法如下：</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">设置单元格属性，从报表中将单元格属性赋给最终的</span><span style=" COLOR: #3f7f5f; ">ireport</span><span style=" COLOR: #3f7f5f; ">，此处需要不同属性分别要设置，具体属性名参照润乾</span><span style=" COLOR: #3f7f5f; ">API</span><span style=" COLOR: #3f7f5f; ">文档</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">public</span></b><span style=" COLOR: black; "> </span><b><span style=" COLOR: #7f0055; ">void</span></b><span style=" COLOR: black; "> setICell(INormalCell iCell, INormalCell inc) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><b><span style=" COLOR: #7f0055; ">if</span></b><span style=" COLOR: black; "> (iCell != </span><b><span style=" COLOR: #7f0055; ">null</span></b><span style=" COLOR: black; ">) {</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setValue(iCell.getValue());</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setFontName(iCell.getFontName()); </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">设置字体</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setFontSize(iCell.getFontSize()); </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">设置字号</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setForeColor(iCell.getForeColor()); </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">设置前景色</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setBackColor(iCell.getBackColor()); </span><span style=" COLOR: #3f7f5f; ">// </span><span style=" COLOR: #3f7f5f; ">设置背景色</span><span style=" COLOR: #3f7f5f; ">&nbsp; </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setBBColor(iCell.getBBColor()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setBBStyle(iCell.getBBStyle()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setBBWidth(iCell.getBBWidth()); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setLBColor(iCell.getLBColor()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setLBStyle(iCell.getLBStyle()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setLBWidth(iCell.getLBWidth()); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setRBColor(iCell.getRBColor()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setRBStyle(iCell.getRBStyle()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setRBWidth(iCell.getRBWidth());&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setTBColor(iCell.getTBColor()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setTBStyle(iCell.getTBStyle()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setTBWidth(iCell.getTBWidth()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setHAlign(iCell.getHAlign()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setFontSize(iCell.getFontSize()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setBold(iCell.isBold()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inc.setItalic(iCell.isItalic()); </span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">&nbsp;&nbsp;&nbsp; }</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">附件中提供了完整的测试用例，请用户下载试用。</span></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; "></span>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><b><span style=" ">总结</span></b></p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><b><span style=" "></span></b>&nbsp;</p> 
  <br /> 
  <p style="TEXT-ALIGN: left; BACKGROUND: white" class="MsoNormal" align="left"><span style=" COLOR: black; ">由上述可以看出，借助强大的<span>API</span>，看似无从下手的问题，也被巧妙的解决，帮助用户解决某些特殊的需求。</span></p> 
  <br /> 
  <p></p>  
 </body>
</html>