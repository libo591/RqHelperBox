<html>
 <head></head> 
 <body> 
  <p>润乾报表单元格样式的设置，是针对每个单元格，样式作为单元格的属性加载在单元格中。报表提供的“添加到样式”功能将定义好的单元格样式添加到样式列表里，如果其他单元格的样式与定义过的单元格样式一样，那么就不用再重复设置，直接使用定义过的样式就可以了。设置了样式之后的单元格，该样式会作为单元格属性绑定在单元格中。<br /> 目前V4的设计器提供的样式设置功能不支持单元格样式的批量修改，也不支持CSS样式文件的设计器引入，但是报表发布页面中可以引入css文件对报表样式进行整体控制。<br /> <strong>实现思路：<br /> </strong>报表通过tag标签发布时，tag标签的name属性值（一般情况下设置name属性为report1）是报表在网页中的标识名，报表发布后会变成html的table，其id为report1，扩展后的单元格为table的td元素并且它们具有扩展后的id命名规则。因此可以定义控制html中table元素样式的css文件，并在报表展现的页面中引入css文件，这样就可以通过css控制报表单元格的样式。<br /> 下面的例子中实现了切换css样式文件达到报表换肤效果，通过单选按钮选择就可以完成css文件对报表样式的整体控制。<br /> &nbsp;<img src="/wp-content/uploads/2011/07/9705d69d-9e88-4e01-aa0f-aca153d8205e.jpg" border="0" alt="" /><br /> &nbsp;<img src="/wp-content/uploads/2011/07/cae81255-b979-4768-839f-c813361f07dc.jpg" border="0" alt="" /><br /> 实现步骤：<br /> 1.&nbsp;css文件定义，分别定义两个css文件(a.css,b.css)，在其中进行样式定义。<br /> 可做如下定义：<br /> body {<br /> &nbsp;&nbsp;&nbsp; font: normal 11px auto “Trebuchet MS”, Verdana, Arial, Helvetica, sans-serif;<br /> &nbsp;&nbsp;&nbsp; color: #4f6b72;<br /> &nbsp;&nbsp;&nbsp; background: #E6EAE9;<br /> }<br /> caption {<br /> &nbsp;&nbsp;&nbsp; padding: 0 0 5px 0;<br /> &nbsp;&nbsp;&nbsp; width: 700px;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp; font:&nbsp; 15px “Trebuchet MS”, Verdana, Arial, Helvetica, sans-serif;<br /> &nbsp;&nbsp;&nbsp; text-align: right;<br /> }<br /> a {<br /> &nbsp;color: #A7C942;<br /> &nbsp;text-decoration:none;<br /> }<br /> #report1 {<br /> &nbsp;&nbsp;&nbsp; width: 800px;<br /> &nbsp;&nbsp;&nbsp; padding: 1;<br /> &nbsp;&nbsp;&nbsp; margin: 1;<br /> }<br /> #report1&nbsp; td {<br /> &nbsp;&nbsp; font:&nbsp; 11px “Trebuchet MS”, Verdana, Arial, Helvetica, sans-serif;<br /> &nbsp;&nbsp;&nbsp; border-right: 2px solid #C1DAD7;<br /> &nbsp;&nbsp;&nbsp; border-left: 2px solid #C1DAD7;<br /> &nbsp;&nbsp;&nbsp; border-bottom: 1px solid #C1DAD7;<br /> &nbsp;&nbsp;&nbsp; border-top: 1px solid #C1DAD7;<br /> &nbsp;&nbsp;&nbsp; background:&nbsp; #F5FAFA;<br /> &nbsp;&nbsp;&nbsp; font-size:11px;<br /> &nbsp;&nbsp;&nbsp; padding: 6px 6px 6px 12px;<br /> &nbsp;&nbsp;&nbsp; color: #4f6b72;<br /> }<br /> 2.&nbsp;报表模板准备<br /> 3.&nbsp;报表发布jsp页面<br /> 部分代码：<br /> &lt;head&gt;<br /> &nbsp;&lt;title&gt;css样式控制&lt;/title&gt;<br /> &lt;!–css文件引入–&gt;<br /> &nbsp;&lt;link id=”cssfile” rel=”stylesheet” type=”text/css” href=”a.css”&gt;<br /> &lt;/head&gt;<br /> ……<br /> &lt;!–用javascript动态改变link中href的内容达到css文件切换效果–&gt;<br /> &lt;input type=”radio” name=”bt1″ value=”1″ onclick=”document.all.cssfile.href=’a.css’”&gt;<br /> &nbsp;&nbsp;a.css<br /> &lt;input type=”radio” name=”bt2″ value=”2″ onclick=”document.all.cssfile.href=’b.css’”&gt;<br /> &nbsp;&nbsp;b.css<br /> ……<br /> &lt;!—利用tag标签进行报表发布–&gt;<br /> &lt;table align=”center” width=”100%” height=”100%”&gt;<br /> &nbsp; &lt;caption&gt;CSS样式切换&lt;/caption&gt;<br /> &nbsp;&lt;tr&gt;&lt;td&gt;<br /> &nbsp;&nbsp;&lt;report:html name=”report1″ reportFileName=”&lt;%=report%&gt;”<br /> &nbsp;&nbsp;&nbsp;funcBarLocation=”top”<br /> &nbsp;&nbsp;&nbsp;needPageMark=”yes”<br /> &nbsp;&nbsp;&nbsp;generateParamForm=”no”<br /> &nbsp;&nbsp;&nbsp;params=”&lt;%=param.toString()%&gt;”<br /> &nbsp;&nbsp;&nbsp;needPivot=”yes”<br /> &nbsp;&nbsp;&nbsp;exceptionPage=”/reportJsp/myError2.jsp”<br /> &nbsp;&nbsp;&nbsp;appletJarName=”runqianReport4Applet.jar,dmGraphApplet.jar”<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /> &nbsp;&nbsp;/&gt;<br /> &nbsp;&lt;/td&gt;&lt;/tr&gt;<br /> &lt;/table&gt;<br /> 存在问题：<br /> 以上方法会有产生一个问题，如果展现的报表模板在设计时如果设置了单元格样式，那么全局的css控制会导致在单元格中定义的样式失效。<br /> 解决办法：<br /> 1.报表模板的A4单元格设置样式，并通过“添加到样式”菜单把该样式保存到了样式列表中。<br /> &nbsp;<img src="/wp-content/uploads/2011/07/d6451947-b360-4879-86ab-e913f5e6d8a2.jpg" border="0" alt="" /><br /> 2.打开\designer\tmp\reportCellStyle.css，其中保存了样式列表中定义好的样式。将样式定义添加到全局css文件中。<br /> 如在a.css中添加如下样式定义<br /> .style_1 {<br /> font-family:Dialog !important;<br /> font-size:12px !important;<br /> visibility:visible !important;<br /> font-weight:normal !important;<br /> font-style:normal !important;<br /> text-decoration:none !important;<br /> text-indent:0.0px !important;<br /> color:#000000 !important;<br /> background-color:#FF6666 !important;<br /> border-bottom-color:#808080 !important;<br /> border-left-color:#808080 !important;<br /> border-right-color:#808080 !important;<br /> border-top-color:#808080 !important;<br /> border-bottom-style:solid !important;<br /> border-bottom-width:0.75px !important;<br /> border-left-style:solid !important;<br /> border-left-width:0.75px !important;<br /> border-right-width:0.75px !important;<br /> border-right-style:solid !important;<br /> border-top-style:solid !important;<br /> border-top-width:0.75px !important;<br /> vertical-align:middle !important;<br /> text-align:center !important;<br /> }<br /> 4.&nbsp;修改单独设置样式的单元格A2的数据类型设置为html，单元格表达式定义为=”&lt;div class=’style_1′&gt;”+ds1.Select(int(EMPID),false)+”&lt;/div&gt;” ，通过html的方式应用了css样式。<br /> 实现效果<br /> &nbsp;<img src="/wp-content/uploads/2011/07/ea685b8c-6ce7-4ad4-bc60-fcdf8f4204be.jpg" border="0" alt="" /><br /> 通过以上方法就可以单独控制部分单元格的样式，并也可以完成单元格样式的批量修改。如果在css文件中修改了style_1,所有应用了style_1样式的报表单元格的样式也会相应被修改。<br /> 本例具体代码实现详见附件，另外感谢衣大伟提供的实现思路。<br /> </p>  
 </body>
</html>