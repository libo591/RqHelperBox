<html>
 <head></head> 
 <body> 
  <p></p> 
  <p><strong>需求说明：<br /></strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 做好的报表一般上传用的是http方式上传到服务器，那么这个Http上传会出现一个问题如果在上传的过程突然断网那么这个附件就要重新上传了，http方式不会支持续传，那么这里介绍一种ftp方式上传。<br />FTP(File Transfer Protocol，文件传输协议是Internet上使用非常广泛的一种通讯协议，它是为Internet用户进行文件传输(包括文件的上传和下载)而制定的。要想实现FTP文件传输，必须在相连的两端都装有支持FTP协议的软件，装在您的电脑上的叫FTP客户端软件，装在另一端服务器上的叫做FTP服务器端软件。 <br /><strong>实现方法：<br /></strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 先下载一个ftp服务端，在服务端在创建一个用户名、上传的路径、相应的权限，至少要选择一个允许上传，同时在服务端一些过滤具体见附件中提供的ftp服务端，服务端配置好了以后就要通过代码的方式写一个客户端了，代码如下<img border="0" src="/wp-content/uploads/2011/08/4357d178-b8a4-446c-ab5d-8d71e816c650.jpg" /></p> 
  <br /> 
  <p>/**<br />&nbsp;* @description FTP文件上传<br />&nbsp;* @author <br />&nbsp;* @datetime <br />&nbsp;*/<br />public class TestApacheFtpFileOperation {<br />&nbsp;<br />&nbsp;private static final String SERVERIP = “192.168.1.65″;//ftp服务器地址<br />&nbsp;private static final String USERNAME = “mjg”;//ftp上创建的账号<br />&nbsp;private static final String PASSWORD = “123″;//ftp上创建的密码<br />&nbsp;<br />&nbsp;public static void main(String[] args) {<br />&nbsp;&nbsp;System.out.println(“start…”);<br />&nbsp;&nbsp;TestApacheFtpFileOperation.fileUpload();<br />&nbsp;&nbsp;System.out.println(“END…”);<br />&nbsp;}<br />&nbsp;<br />&nbsp;/**<br />&nbsp; *&nbsp;FTP 上传单个文件 <br />&nbsp; */<br />&nbsp;public static void fileUpload(){&nbsp;&nbsp;<br />&nbsp;&nbsp;FTPClient ftpClient = new FTPClient(); <br />&nbsp;&nbsp;FileInputStream fis = null;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;try {<br />&nbsp;&nbsp;&nbsp;ftpClient.connect(SERVERIP); //ftp服务器IP地址<br />&nbsp;&nbsp;&nbsp;ftpClient.login(USERNAME, PASSWORD); //ftp服务器用户名与密码<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;String localUrl=”D:\\123.jpg”;&nbsp; <br />&nbsp;&nbsp;&nbsp;File file = new File(localUrl); //上传本地的一个文件<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;fis = new FileInputStream(file);<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;ftpClient.setBufferSize(1024); //设置缓存<br />&nbsp;&nbsp;&nbsp;ftpClient.setControlEncoding(“UTF-8″); <br />&nbsp;&nbsp;&nbsp;ftpClient.setFileType(FTPClient.BINARY_FILE_TYPE); //设置文件类型(二进制)<br />&nbsp;&nbsp;&nbsp;String rename = “123.jpg”;//放在服务器上的名字，这个时候也可以重命名叫456.jpg<br />&nbsp;&nbsp;&nbsp;ftpClient.storeFile(new String(rename.getBytes(“GBK”),”iso-8859-1″), fis); //保存文件&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;} catch (IOException e) {<br />&nbsp;&nbsp;&nbsp;e.printStackTrace();<br />&nbsp;&nbsp;&nbsp;throw new RuntimeException(“FTP客户端出错!”,e);<br />&nbsp;&nbsp;} finally{<br />&nbsp;&nbsp;&nbsp;IOUtils.closeQuietly(fis);<br />&nbsp;&nbsp;&nbsp;try {<br />&nbsp;&nbsp;&nbsp;&nbsp;ftpClient.disconnect(); //关闭FTP连接<br />&nbsp;&nbsp;&nbsp;} catch (IOException e) {<br />&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br />&nbsp;&nbsp;&nbsp;&nbsp;throw new RuntimeException(“关闭FTP接连失败!”,e);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />&nbsp;}<br />&nbsp;<br />&nbsp;/**<br />&nbsp; *&nbsp;FTP 单个文件下载<br />&nbsp; */<br />&nbsp;public static void fileDownload(){<br />&nbsp;&nbsp;FTPClient ftpClient = new FTPClient(); <br />&nbsp;&nbsp;FileOutputStream fos = null;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;try {<br />&nbsp;&nbsp;&nbsp;ftpClient.connect(SERVERIP); //ftp服务器IP地址<br />&nbsp;&nbsp;&nbsp;ftpClient.login(USERNAME, PASSWORD); //ftp服务器用户名与密码<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;String remoteFile = “/zf/fileStore/new.text”;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;fos = new FileOutputStream(“zf.text”);<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;ftpClient.setBufferSize(1024); //设置缓存&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;ftpClient.setFileType(FTPClient.BINARY_FILE_TYPE); //设置文件类型(二进制)<br />&nbsp;&nbsp;&nbsp;ftpClient.retrieveFile(remoteFile, fos);<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;} catch (IOException e) {<br />&nbsp;&nbsp;&nbsp;e.printStackTrace();<br />&nbsp;&nbsp;&nbsp;throw new RuntimeException(“FTP客户端出错!”,e);<br />&nbsp;&nbsp;} finally{<br />&nbsp;&nbsp;&nbsp;IOUtils.closeQuietly(fos);<br />&nbsp;&nbsp;&nbsp;try {<br />&nbsp;&nbsp;&nbsp;&nbsp;ftpClient.disconnect(); //关闭FTP连接<br />&nbsp;&nbsp;&nbsp;} catch (IOException e) {<br />&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br />&nbsp;&nbsp;&nbsp;&nbsp;throw new RuntimeException(“关闭FTP接连失败!”,e);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}&nbsp;&nbsp;<br />&nbsp;}</p> 
  <br /> 
  <p>}</p> 
  <br /> 
  <p>以上就实现了FTP客户端与服务器端的连接，就可以把附件上传到服务器了，附件中有ftp服务器端、JAVA代码</p> 
  <br /> 
  <p>&nbsp;</p> 
  <br /> 
  <p></p>  
 </body>
</html>