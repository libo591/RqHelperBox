<html>
 <head></head> 
 <body> 
  <p><strong>需求背景</strong></p> 
  <p>在分页报表中，我们想对指定页码下指定行设置一些属性，如：隐藏、前景色、背景色等，能否在报表中就可以判断并且实现呢？</p> 
  <p>下面看一下如何实现这个功能。</p> 
  <p><strong>实现步骤</strong></p> 
  <p><strong>1：设计一张如下的报表</strong>：</p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2010/08/zrclip-019p5d15987e.png" alt="" width="540" height="112" /></p> 
  <p>2：设置参数如下：</p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2010/08/zrclip-020nf9360dc.png" alt="" width="554" height="95" /></p> 
  <p><strong>3：设置分页方式和每页行数：</strong></p> 
  <p><strong><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2010/08/zrclip-021n5a6a0dd8.png" alt="" width="554" height="85" /></strong></p> 
  <p><strong>4：选中报表第二行，设置背景色表达式：</strong></p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2010/08/zrclip-022n19555620.png" alt="" width="553" height="90" /></p> 
  <p>本例中计算页码是通过使用row()函数获得当前行号，而该报表有一个表头，这样的话数据区的行数应该是从2开始，所以这用了int((row()-2)/10+1)表达式求第几页；而表达式中(row()-2)%10其中10是分页记录条数，即该表达式是是求第几行的。</p> 
  <p><strong>5：将发布报表的jsp中设置<span>generateParamForm=”yes”，预览如下：</span></strong></p> 
  <p><span><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2010/08/zrclip-023n7fc2ec6b.png" alt="" width="554" height="280" /></span></p> 
  <p><span>通过这个例子可以发现，我们不单能设置背景色，前景色、隐藏、显示值等都可以设置；还可以设置单元格的相关属性，操作和设置行属性类似。</span></p> 
  <p><span>说明：</span></p> 
  <p><span>1、该例可以直接适合按行分页的报表；<br /> 2、若报表无报表头或含有多行报表头，行属性表达式要有所变化；<br /> 3、如果设置行隐藏，后面的数据会补上一条到本页，使得本页数据仍为满页记录条数（最后一页除外），见下图：</span></p> 
  <p><span><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2010/08/zrclip-024p130f3e44.png" alt="" width="553" height="279" /></span></p>  
 </body>
</html>