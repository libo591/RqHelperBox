<html>
 <head></head> 
 <body> 
  <p><strong>需求描述：<br /> </strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 客户想实现把相关联的报表在一个页面展示出来，这个可以用我们润乾提供了报表组功能来实现他的要求，但是客户发现如果数据量很大，报表组很多的时候报表展现会很慢，测试发现报表组是把所有组的报表在第一次打开的时候就把报表全部查询了一次，就出来了展现速度慢的问题。<br /> <img src="/wp-content/uploads/2011/08/45fbfe4d-ccba-4a60-801c-9b86bd3f8587.jpg" border="0" alt="" /><br /> <strong>解决办法</strong>：<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在对于查询报表可以把页面分成几个标签页用DIV来控制展示，这样打开报表的时候就只查我打开报表的数据，展现慢的问题就解决了，最后在导出的时候用api的方式把几个报表生成一个报表组就可以了。<br /> 第一步：做标签页<br /> &lt;BODY&gt;<br /> &lt;DIV id=con style=”width: 100%;height: 100%”&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;UL id=tags style=”width: 100%”&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;LI&gt;&lt;A onClick=”selectTag(‘tagContent0′,this)” href=”javascript:void(0)”&gt;报表一&lt;/A&gt;&lt;/LI&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;LI class=selectTag&gt;&lt;A onClick=”selectTag(‘tagContent1′,this)” href=”javascript:void(0)”&gt;报表二&lt;/A&gt; &lt;/LI&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;LI&gt;&lt;A onClick=”selectTag(‘tagContent2′,this)” href=”javascript:void(0)”&gt;导出报表组功能&lt;/A&gt; &lt;/LI&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/UL&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;DIV id=tagContent style=”width: 100%;height: 95%”&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DIV class=tagContent id=tagContent0 style=”width: 100%;height: 100%”&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;iframe src=”../../reportJsp/gaoji.jsp?raq=zunei.raq” width=”100%” height=”100%”&gt;&lt;/iframe&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DIV&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DIV class=”tagContent selectTag” id=tagContent1&nbsp; style=”width: 100%;height: 100%”&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;iframe src=”../../reportJsp/gaoji.jsp?raq=tongqibitwo.raq” width=”100%” height=”100%”&gt;&lt;/iframe&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DIV&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DIV class=tagContent id=tagContent2&nbsp; style=”width: 100%”&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;iframe src=”zu.jsp” width=”100%” height=”100%”&gt;&lt;/iframe&gt;<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DIV&gt;<br /> &nbsp;&nbsp;&nbsp; &lt;/DIV&gt;<br /> &lt;/DIV&gt;<br /> &lt;SCRIPT type=text/javascript&gt;<br /> function selectTag(showContent,selfObj){<br /> &nbsp;&nbsp;&nbsp; // 标签<br /> &nbsp;&nbsp;&nbsp; var tag = document.getElementById(“tags”).getElementsByTagName(“li”);<br /> &nbsp;&nbsp;&nbsp; var taglength = tag.length;<br /> &nbsp;&nbsp;&nbsp; for(i=0; i&lt;taglength; i++){<br /> &nbsp;&nbsp;&nbsp; tag[i].className = “”;<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; selfObj.parentNode.className = “selectTag”;<br /> &nbsp;&nbsp;&nbsp; // 标签内容<br /> &nbsp;&nbsp;&nbsp; for(i=0; j=document.getElementById(“tagContent”+i); i++){<br /> &nbsp;&nbsp;&nbsp;<br /> &nbsp;&nbsp;&nbsp; j.style.display = “none”;<br /> &nbsp;&nbsp;&nbsp; }<br /> &nbsp;&nbsp;&nbsp; document.getElementById(showContent).style.display = “block”;<br /> }<br /> &lt;/SCRIPT&gt;<br /> &lt;/BODY&gt;<br /> 第二步：api生成报表组<br /> List&lt;String&gt; list = new ArrayList&lt;String&gt;();<br /> String path=request.getSession().getServletContext().getRealPath(“reportFiles\\高级报表”);<br /> list.add(path+”/tongqibitwo.raq”);<br /> list.add(path+”/zunei.raq”);<br /> out.println(“生成”+list.size()+”个raq文件&nbsp; 目录 “+path+”/baobiaozu.xls”);<br /> ExcelReport er = new ExcelReport();<br /> for(int i = 0; i&lt;list.size(); i++){<br /> ReportDefine rd = (ReportDefine)ReportUtils.read(list.get(i));<br /> Context ctx = new Context();<br /> Engine engine = new Engine(rd,ctx);<br /> IReport ireport = engine.calc();<br /> er.export(“sheet_”+String.valueOf(i),ireport);<br /> }<br /> er.saveTo(path+”/baobiaozu.xls”);<br /> <img src="/wp-content/uploads/2011/08/26cf5d54-2e08-4300-9904-80927c8f468a.jpg" border="0" alt="" /><br /> </p>  
 </body>
</html>