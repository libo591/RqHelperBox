<html>
 <head></head> 
 <body> 
  <p></p> 
  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Lotus Domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">是当今办公自动化系统的主流开发平台之一，</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">自带一个非关系型数据库</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">——</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">文档型数据库，而目前大部分企业的信息都储存在诸如</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">SQL Server</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">等关系型数据库中，因此，在开发办公自动化系统过程中势必要涉及</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">和关系数据库的数据交换问题。下面介绍一些润乾报表从</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">数据库取数的方法。主要分两种方式：</span></p> 
  <br /> 
  <p class="MsoNormal"><strong><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">一：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">JDBC</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">方式</span></strong></p> 
  <br /> 
  <p class="MsoNormal" style="MARGIN-LEFT: 36pt; TEXT-INDENT: -36pt; tab-stops: list 36.0pt"><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"><span>1、<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">需要的环境：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br /></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">在连接前必须安装：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />a.Sun JDK 1.1.6</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">或是更高的版本，并设置</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">JVM</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">的环境。</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />b.Lotus Domino Server 4.6 </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">或是更高的版本。</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />c.Lotus Domino Driver for JDBC 1.1 </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">。</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />2</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">、连接程序编写：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />a.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">必须将包</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> lotus.jdbc.domino.* </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">包含在程序开头。例：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">import lotus.jdbc.domino.* <br />b.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">调出</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">的驱动程序。例：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Class.forName(lotus.jdbc.domino.DominoDriver); </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">注意捕捉</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">ClassNotFoundException</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">异常。</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />c.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">给出</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">JDBC URL</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">。例：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">url=jdbc:domino:/DatabaseName.nsf/ServerName </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">解释为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">jdbc:domino: </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">JDBC URL</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">连接协议的固定字，</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">DatabaseName.nsf </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">数据库文件名，</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">ServerName </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Domino</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">服务器名。假设连接服务器名为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Webserver</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">上的</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">names.nsf , url=jdbc:domino:/names.nsf/webserver ;</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">假设连接服务器名为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Webserver</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">，</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">office</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">目录下的</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">job.nsf , url=jdbc:domino:/officejob.nsf/webserver ;</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">设置连接超时</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">100</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">秒，</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">url=jdbc:domino:/simpler.nsf;threadtimeout=100 </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">。</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />d. </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">建立连接。</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">Connection con = DriverManager.getConnection(String JDBCURL); <br />3</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">、部分连接例程：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana"> <br />import java.sql.*; <br />import lotus.jdbc.domino.*; <br />public class example{ <br />public static void main (String[] args) { <br />Connection con=null; <br />Statement stmt=null; <br />ResultSet rs=null; <br />String sql= SELECT * FROM Person; <br />String connStr = jdbc:domino:/names.nsf/webserver/weboa; <br />Class.forName(lotus.jdbc.domino.DominoDriver); <br />con = DriverManager.getConnection(connStr); <br />stmt = con.createStatement(); <br />rs = stmt.executeQuery(sql); … .. }} <br /><br />4</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">、在润乾自定义数据集中，只需要将该连接例程获得的结果集转化为</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">DATESET</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">二维数组即可。</span></p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">注意：</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">1</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">：客户端要装</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Verdana">lotus</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">客户端</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 'Microsoft YaHei'">lotus notes</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">，保证能正常连接</span></p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 'Microsoft YaHei'"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">2</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">：将<span>jdbc</span>驱动放置到数据库端</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 'Microsoft YaHei'">Lotus\Notes\jvm\lib\ext</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">下，重启数据库</span></p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体"></span>&nbsp;</p> 
  <br /> 
  <p class="MsoNormal"><strong><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">二：</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 'Microsoft YaHei'">ODBC</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">方式</span></strong></p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 宋体">虽然能用<span>JDBC</span>方式连接<span>domino</span>数据库，</span><span style="FONT-FAMILY: 宋体">但是</span><span>IBM</span><span style="FONT-FAMILY: 宋体">后来又对这种方式抛弃掉了。所以</span><span>Notes6</span><span style="FONT-FAMILY: 宋体">以后多是通过</span><span>IBM</span><span style="FONT-FAMILY: 宋体">提供的</span><span>ODBC</span><span style="FONT-FAMILY: 宋体">驱动来连接</span><span>Domino/Notes</span><span style="FONT-FAMILY: 宋体">数据库的。</span></p> 
  <br /> 
  <p class="MsoNormal"><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">下面是在润乾报表中使用</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Tahoma">ODBC</span><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: 宋体">连接</span><span>Domino/Notes</span><span style="FONT-FAMILY: 宋体">数据库的步骤。</span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt"><span><span>1.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-FAMILY: 宋体">安装</span><span>NotesSQL</span><span style="FONT-FAMILY: 宋体">，并使用</span><span>Authentication List Manager</span><span style="FONT-FAMILY: 宋体">来配置到数据库服务器的</span><span>ODBC</span><span style="FONT-FAMILY: 宋体">授权。</span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: 0cm"><span style="FONT-FAMILY: 宋体">下载</span><span>NotesSQL</span><span style="FONT-FAMILY: 宋体">安装包，并安装完成。</span><span>Authentication List Manager</span><span style="FONT-FAMILY: 宋体">配置页面如下：</span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: 0cm; TEXT-ALIGN: center" align="center"><span><img height="497" src="/wp-content/uploads/2011/06/3e7e22ec-14ba-466a-8e74-0fbb3dc53d98.jpg" width="536" /></span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt"><span><span>2.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-FAMILY: 宋体">配置</span><span>WINDOWS</span><span style="FONT-FAMILY: 宋体">系统</span><span>Domino/Notes ODBC</span><span style="FONT-FAMILY: 宋体">数据源。</span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: 0cm"><span><img height="329" src="/wp-content/uploads/2011/06/fe012e98-67bf-4f1b-90e1-2c815cadb301.jpg" width="459" /></span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt"><span><span>3.<span style="FONT: 7pt 'Times New Roman'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="FONT-FAMILY: 宋体">在润乾报表设计器中配置</span><span>Domino/Notes ODBC</span><span style="FONT-FAMILY: 宋体">数据源。</span></p> 
  <br /> 
  <p class="a" style="MARGIN-LEFT: 18pt; TEXT-INDENT: 0cm"><span><img height="290" src="/wp-content/uploads/2011/06/5d10185a-4d67-460f-bbe8-a5940a9234ba.jpg" width="411" /></span></p> 
  <br /> 
  <p class="MsoNormal">&nbsp;</p> 
  <br /> 
  <p class="MsoNormal">&nbsp;</p> 
  <br /> 
  <p></p>  
 </body>
</html>