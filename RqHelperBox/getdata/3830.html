<html>
 <head></head> 
 <body> 
  <p class="MsoNormal"><span style="font-family: 宋体;">需求描述：一张报表上面是网格报表下面是分栏<a href="http://www.runqian.com.cn">报表</a>。通过设计器可以使用主子表的方式，把网格报表放到子表中，但是需求里的分栏报表又不是简简单单的分栏，里面包含了多层的分组表头。如下图所示。</span></p> 
  <p class="MsoNormal"><span><img src="/wp-content/uploads/2011/07/d1536878-8ce5-4185-bbca-4787a66f937a.jpg" alt="" width="467" height="552" /></span></p> 
  <p class="MsoNormal">&nbsp;</p> 
  <p class="MsoNormal"><span style="font-family: 宋体;">所以在分组报表这块使用了行属性中的“分组表头”来实现多表头的分栏报表。</span></p> 
  <p class="MsoNormal"><span style="font-family: 宋体;">到时由于报表中的行类型的界别限制，在表头区域上面的行无法设成数据区，所以用了标题区来代替。</span></p> 
  <p class="MsoNormal"><span><img src="/wp-content/uploads/2011/07/87beb390-c0ac-444c-8678-b23c28d33f5b.jpg" alt="" width="515" height="359" /></span></p> 
  <p class="MsoNormal"><span style="font-family: 宋体;">可是新的问题也随之产生，对于子表中的数据量如果过多，标题区是无法分页的，导致整套的报表不能分页显示。</span></p> 
  <p class="MsoNormal">&nbsp;</p> 
  <p class="MsoNormal"><span style="font-family: 宋体;">之前的实现思路是将一张报表拆分成两张，然后通过</span><span>PageBuilder</span><span style="font-family: 宋体;">将两表中每一页都拆分成多个</span><span>rat</span><span style="font-family: 宋体;">，再将第一张表的最后一页对应到第二张表的第一页前的空白行中，写入数据，这种方式可以很好的实现这种复杂功能。优点在于两张表的行高可以随意设置，不需要互相对应，代码量比较简单。缺点在于，分页导出等功能需要另外实现。</span></p> 
  <p class="MsoNormal">&nbsp;</p> 
  <p class="MsoNormal"><span style="font-family: 宋体;">经过思考以及客户对导出分页等功能的需求，研究了第二种方式，原理是通过</span><span>api</span><span style="font-family: 宋体;">提前创建出一张空白的</span><span>raq</span><span style="font-family: 宋体;">（注意：是</span><span>raq</span><span style="font-family: 宋体;">），还是先将第一张表的最后页数据写入第二张表的开始，再通过</span><span>PageBuilder</span><span style="font-family: 宋体;">将每一页拆分成多个</span><span>rat</span><span style="font-family: 宋体;">，读取全部的行数，为之前创建的</span><span>raq</span><span style="font-family: 宋体;">增加空白行，再遍历每张</span><span>rat</span><span style="font-family: 宋体;">的单元格，将其属性写入到</span><span>raq</span><span style="font-family: 宋体;">中，由于</span><span>rat</span><span style="font-family: 宋体;">到</span><span>raq</span><span style="font-family: 宋体;">的单元格写入有局限性，无法直接将</span><span>INormalCell</span><span style="font-family: 宋体;">直接赋值到</span><span>raq</span><span style="font-family: 宋体;">中，所以需要取得属性后，将属性赋值到</span><span>raq</span><span style="font-family: 宋体;">中。并且对于合并单元格的赋值也需要利用到</span><span>api</span><span style="font-family: 宋体;">动态合并单元格的功能。最后得到一个</span><span>ReportDefine</span><span style="font-family: 宋体;">的结果对</span><span style="font-family: 宋体; color: black; font-size: 10pt;">象，通过</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">defineBean</span><span style="font-family: 宋体; color: black; font-size: 10pt;">的形式通过标签来展现报表，分页导出等功能自然就能实现了，此方法优点在于客户体验度比较理性具有和以往报表页面中的操作功能，具有一定的通用性，缺点在于，报表的单元格高度需要强制要求，否则写入</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">后的分页样式会不同，代码量也比较大。</span></p> 
  <p class="MsoNormal">&nbsp;</p> 
  <p class="MsoNormal"><span style="font-family: 宋体; color: black; font-size: 10pt;">下面我们按照上述的解决方案来实现该需求以及部分代码：</span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;">1</span><span style="font-family: 宋体; font-size: 10pt;">，首先根据传入的报表列数创建一张空白的报表</span><span style="font-family: 'Courier New'; font-size: 10pt;">raq</span><span style="font-family: 宋体; font-size: 10pt;">（也就是</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">ReportDefine</span><span style="font-family: 宋体; color: black; font-size: 10pt;">，这里也可以创建计算好的报表</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: black; font-size: 10pt;">，但是考虑到最后要使用标签形式读取，随意采用的写入</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">中的方案</span><span style="font-family: 宋体; font-size: 10pt;">）</span></p> 
  <p class="MsoNormal" style="text-align: left; text-indent: 21pt;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">ReportDefine rdStatic = </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> ReportDefine2(1, col);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 宋体; color: black; font-size: 10pt;">获取需要对该</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">ReportDefine</span><span style="font-family: 宋体; color: black; font-size: 10pt;">对象增加多少空白行，计算行数是通过计算两张报表的总和</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span>rdStatic.addRow(allAddRow(report_sub, report));</span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;">2</span><span style="font-family: 宋体; font-size: 10pt;">，创建好了</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">N</span><span style="font-family: 宋体; color: black; font-size: 10pt;">多空行的</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">后，下面要做的就是将两张报表拆分整理写入这个</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">中。首先是第一张报表（除最后一页）</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span>1</span><span style="font-family: 宋体; color: black; font-size: 10pt;">）计算子报表，也就是需求中上面的网格式报表（由于子表最后一页的数据要写入第二张表的前面，所以这一步无需计算最后一页的数据）</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">计算子表（只计算整页数的）</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport ireport_sub = toReport(report_sub);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> pagecount_sub = allPage(ireport_sub);</span></p> 
  <p class="MsoNormal" style="text-align: left; text-indent: 21pt;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">2</span><span style="font-family: 宋体; color: black; font-size: 10pt;">）通过</span><span>PageBuilder</span><span style="font-family: 宋体;">按页进行拆分，然后逐页逐行的写入之前创建好的</span><span>raq</span><span style="font-family: 宋体;">中。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">*</span></span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> setICell ()</span><span style="font-family: 宋体; color: black; font-size: 10pt;">这个方法是将</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: black; font-size: 10pt;">单元格属性写入到</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">中，在后面会介绍。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">对子表进行按页拆分</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">(</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">除了最后一页</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">)</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> page = 1; page &lt; pagecount_sub; page++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport ir = </span><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">pb</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.getPage(page);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ir.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> j = 1; j &lt;= ir.getColCount(); j++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell iCell = ir.getCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell inc = rdStatic.getCell((i + (page – 1)</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>* ir.getRowCount()), (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>setICell(iCell, inc);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;">3</span><span style="font-family: 宋体; font-size: 10pt;">，写入第一张报表的最后一页，以及第二张报表第一页</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span>1</span><span style="font-family: 宋体; font-size: 10pt;">）获取第一张表最后一页行数，然后再第二张报表第一行前插入相应行数并且设置行类别</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">获取子表最后一页，在主表中增加相应行数，将数据写入</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport ir_sub_end = </span><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">pb</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.getPage(pagecount_sub);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ir_sub_end.getRowCount();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">将主表中增加取得的行数并设置行属性为标题</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReportDefine rd = (ReportDefine) ReportUtils.<em>read</em>(report);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rd.insertRow(1, ir_sub_end.getRowCount());</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ir_sub_end.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IRowCell rowcell = rd.getRowCell(i); </span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">根据行号获得行首格</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rowcell.setRowType(IRowCell.</span><em><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">TYPE_TITLE_HEADER</span></em><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span>2</span><span style="font-family: 宋体; color: black; font-size: 10pt;">）将第一张表最后页数据写入第二张表之前插入的空行内。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport iReport = toReport(rd);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">将数据写入主表空白单元格内</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">pb</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> = </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> PageBuilder(iReport);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport ir_begin = </span><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">pb</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.getPage(1);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ir_begin.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IRowCell rowcell = ir_begin.getRowCell(i);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rowcell.setRowType(IRowCell.</span><em><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">TYPE_NORMAL</span></em><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ir_sub_end.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> j = 1; j &lt;= ir_sub_end.getColCount(); j++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell iCell = ir_sub_end.getCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ir_begin.setCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j, iCell);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span>3</span><span style="font-family: 宋体; font-size: 10pt;">）这样第一张表的最后一页再加上第二张表的前面一段数据就合成了</span><span style="font-family: 'Courier New'; font-size: 10pt;">1</span><span style="font-family: 宋体; font-size: 10pt;">整页的效果，一起写入到</span><span style="font-family: 'Courier New'; font-size: 10pt;">raq</span><span style="font-family: 宋体; font-size: 10pt;">中。由于之前已经写入了一部分内容，所以循环写入的位置需要重新计算下。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">将填好数据的主表第一页写入最终的</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">ireport</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">中</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ir_begin.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> j = 1; j &lt;= ir_begin.getColCount(); j++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell iCell = ir_begin.getCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell inc = rdStatic.getCell(i</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+ ireport_sub.getRowCount() – ir_sub_end.getRowCount(),</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>setICell(iCell, inc);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">3</span><span style="font-family: 宋体; color: black; font-size: 10pt;">，将第二张表剩下的部分写入到</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">的最后面，同样是需要计算下循环写入的位置。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">将主表中后几页写入最终的</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">ireport</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">中</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> page_i = </span><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">pb</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.getPage(2).getRowCount();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> page = 2; page &lt;= allPage(iReport); page++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport ir = </span><span style="font-family: 'Courier New'; color: #0000c0; font-size: 10pt;">pb</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.getPage(page);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ir.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> j = 1; j &lt;= ir.getColCount(); j++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell iCell = ir.getCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i1 = (ireport_sub.getRowCount()</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>- ir_sub_end.getRowCount() + ir_begin.getRowCount())</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+ (page – 2) * page_i;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell inc = rdStatic.getCell(i + i1, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>setICell(iCell, inc);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">4</span><span style="font-family: 宋体; color: black; font-size: 10pt;">，由于</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: black; font-size: 10pt;">和</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">见有着一些微妙的区别，有些属性是无法复制过去的，例如合并单元格。所以采用了对报表本身增加标识，然后通过动态合并单元格的方法。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 宋体; color: black; font-size: 10pt;">在报表中对合并单元格的数据前增加标识“</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">#</span><span style="font-family: 宋体; color: black; font-size: 10pt;">”</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;"><img src="/wp-content/uploads/2011/07/a6a7e747-70d9-4cd7-932d-a5f1c4780cdc.jpg" alt="" width="479" height="100" /></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; font-size: 10pt;"><img src="/wp-content/uploads/2011/07/5360a1c2-ed77-484f-b9da-30af98c68e5b.jpg" alt="" width="275" height="137" /></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">计算最终报表，去掉合并单元格标识</span></p> 
  <p class="MsoNormal" style="text-align: left; text-indent: 21pt;"><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">进行有标识的单元格合并</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">public</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">static</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">void</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> mergeReport(ReportDefine ireportStatic) </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">throws</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> Exception {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String dealFlag = </span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“#”</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">报表中对数据进行了标识，为了是后面进行单元格合并时的判断标志</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = ireportStatic.getRowCount(); i &gt;= 1; i–) {</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">遍历</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">的行列</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> j = ireportStatic.getColCount(); j &gt;= 1; j–) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell cell0 = ireportStatic.getCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">逐行逐列取得单元格</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">byte</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> extMode = cell0.getExtendMode();</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">获取扩展区域</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (j != 1 &amp;&amp; cell0.getValue() != </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">null</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (cell0.getValue().toString().indexOf(dealFlag) &gt;= 0) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell cell1 = ireportStatic.getCell(i,</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) (j – 1));</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> mAreaDStartCol, mAreaDEndCol, mAreaUStartCol, mAreaUEndCol;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mAreaDStartCol = cell0.isMerged() ? cell0</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.getMergedArea().getBeginCol() : j;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mAreaDEndCol = cell0.isMerged() ? cell0.getMergedArea()</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.getEndCol() : j;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mAreaUStartCol = cell1.isMerged() ? cell1</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.getMergedArea().getBeginCol()</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: mAreaDStartCol – 1;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mAreaUEndCol = cell1.isMerged() ? cell1.getMergedArea()</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.getEndCol() : mAreaDEndCol – 1;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (cell1.getValue() != </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">null</span></strong></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&amp;&amp; cell1.getValue().equals(cell0.getValue())) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell1.setValue(cell0.getValue());</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Area area = </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> Area(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) mAreaUStartCol, i,</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) mAreaDEndCol);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReportUtils.<em>mergeReport</em>(ireportStatic, area);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (cell0.getValue().equals(dealFlag)) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Area area = </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> Area(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) mAreaUStartCol, i,</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) mAreaDEndCol);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReportUtils.<em>mergeReport</em>(ireportStatic, area);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">将没有用到的单元格中的标识</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">#</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">去掉</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> i = 1; i &lt;= ireportStatic.getRowCount(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">int</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> j = 1; j &lt;= ireportStatic.getColCount(); j++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell cell2 = ireportStatic.getCell(i, (</span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">short</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) j);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (cell2.getValue() != </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">null</span></strong></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&amp;&amp; cell2.getValue().toString().indexOf(dealFlag) &gt;= 0) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cell2.setValue(cell2.getValue().toString().replace(</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dealFlag, </span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“”</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">));</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">5</span><span style="font-family: 宋体; color: black; font-size: 10pt;">，最后在</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">jsp</span><span style="font-family: 宋体; color: black; font-size: 10pt;">页面中直接调用此方法获取到最终的</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">reportDefine</span><span style="font-family: 宋体; color: black; font-size: 10pt;">，通过</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">defineBean</span><span style="font-family: 宋体; color: black; font-size: 10pt;">的方式展现即可。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">request.setAttribute(reportDefine, mr.apiToReport(</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“D://pp_sub.raq”</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"></span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“D://pp.raq”</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">, 8));</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: teal; font-size: 10pt;">&lt;</span><span style="font-family: 'Courier New'; color: #3f7f7f; font-size: 10pt;">report:html </span><span style="font-family: 'Courier New'; color: #7f007f; font-size: 10pt;">name</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">=</span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“report1″ </span><span style="font-family: 'Courier New'; color: #7f007f; font-size: 10pt;">srcType</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">=</span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“defineBean”</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New'; color: #7f007f; font-size: 10pt;">beanName</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">=</span><span style="font-family: 'Courier New'; color: #2a00ff; font-size: 10pt;">“</span><span style="font-family: 'Courier New'; color: #bf5f3f; font-size: 10pt;">&lt;%=</span><span style="font-family: 'Courier New'; font-size: 10pt;">r<span style="color: black;">eportDefine</span><span style="color: #bf5f3f;">%&gt;</span>“<span style="color: black;"> </span><span style="color: teal;">/&gt;</span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体; color: black; font-size: 10pt;">页面效果如下：</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><img src="/wp-content/uploads/2011/07/2f596e2f-f461-4db1-8854-95c3b93110c2.jpg" alt="" width="349" height="535" /></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体; color: black; font-size: 10pt;">附</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">1</span><span style="font-family: 宋体; color: black; font-size: 10pt;">：文中采用的方法是将</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: black; font-size: 10pt;">的数据写入到</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">中，在操作过程中发现了一些问题。</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体; color: black; font-size: 10pt;">虽然</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">reportDefine</span><span style="font-family: 宋体; color: black; font-size: 10pt;">（</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">）实现了</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">IReport</span><span style="font-family: 宋体; color: black; font-size: 10pt;">（</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: black; font-size: 10pt;">）接口，它俩的方法也都是完全一样，可是在将</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">rat</span><span style="font-family: 宋体; color: black; font-size: 10pt;">的单元格写入到</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">raq</span><span style="font-family: 宋体; color: black; font-size: 10pt;">中，原本认为直接通过</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">set</span><span style="font-family: 宋体; color: black; font-size: 10pt;">、</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">get</span><span style="font-family: 宋体; color: black; font-size: 10pt;">方法将</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">INormalCell</span><span style="font-family: 宋体; color: black; font-size: 10pt;">赋值过去即可，却无法达到预期效果，后台报错，所以采取了逐个赋值</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">INormalCell</span><span style="font-family: 宋体; color: black; font-size: 10pt;">中的属性的方法，方法如下：</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">设置单元格属性，从报表中将单元格属性赋给最终的</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">ireport</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">，此处需要不同属性分别要设置，具体属性名参照润乾</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">API</span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">文档</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">public</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">void</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> setICell(INormalCell iCell, INormalCell inc) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"> (iCell != </span><strong><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">null</span></strong><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setValue(iCell.getValue());</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setFontName(iCell.getFontName()); </span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">设置字体</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setFontSize(iCell.getFontSize()); </span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">设置字号</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setForeColor(iCell.getForeColor()); </span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">设置前景色</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setBackColor(iCell.getBackColor()); </span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;">// </span><span style="font-family: 宋体; color: #3f7f5f; font-size: 10pt;">设置背景色</span><span style="font-family: 'Courier New'; color: #3f7f5f; font-size: 10pt;"><span></span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setBBColor(iCell.getBBColor()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setBBStyle(iCell.getBBStyle()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setBBWidth(iCell.getBBWidth()); <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setLBColor(iCell.getLBColor()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setLBStyle(iCell.getLBStyle()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setLBWidth(iCell.getLBWidth()); <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setRBColor(iCell.getRBColor()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setRBStyle(iCell.getRBStyle()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setRBWidth(iCell.getRBWidth());<span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setTBColor(iCell.getTBColor()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setTBStyle(iCell.getTBStyle()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setTBWidth(iCell.getTBWidth()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setHAlign(iCell.getHAlign()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setFontSize(iCell.getFontSize()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setBold(iCell.isBold()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setItalic(iCell.isItalic()); </span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 宋体; color: black; font-size: 10pt;">附件中提供了完整的测试用例。</span></p> 
  <p class="MsoNormal">&nbsp;</p> 
  <p></p>  
 </body>
</html>