<html>
 <head></head> 
 <body> 
  <h2 style="text-indent: 0cm; margin-left: 0cm; tab-stops: list 32.75pt;"><span style="font-size: 12pt;">1.<span style="font: 12pt 宋体;"> </span><span style="font-family: 宋体; font-size: 12pt;">报表需求</span></span></h2> 
  <p class="MsoListParagraph" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><strong><span>业务：</span></strong><span style="font-family: 宋体; font-size: 12pt;">主要供营业部柜台人员，对客户数量、有效客户数、客户资产、中高端客户进行统计。</span><strong>&nbsp;</strong></span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><strong><span>样式：</span></strong><strong>&nbsp;</strong></span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;"><img src="http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=3dd0ea16-17d9-499d-8e3e-ae2e0f49e5fa" alt="" width="553" height="182" /></span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><strong><span>数据量</span></strong><strong><span></span></strong><span style="font-family: 宋体; font-size: 12pt;">需要统计的数据量</span>200-500<span style="font-family: 宋体; font-size: 12pt;">万。</span></span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><strong><span>性能要求：</span></strong><span style="font-family: 宋体; font-size: 12pt;">秒级出来报表，支持</span>50<span style="font-family: 宋体; font-size: 12pt;">左右的并发。</span></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm; tab-stops: list 32.75pt;"><span style="font-size: 12pt;">2.<span style="font: 12pt 宋体;"> </span><span style="font-family: 宋体; font-size: 12pt;">原实现方式</span></span></h2> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">2.1<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">数据集</span></span></h2> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;"><img src="http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=5be3133c-c59f-4619-bf1f-36574cdf64e7" alt="" width="477" height="158" /></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">2.2<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">报表设计</span></span></h2> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;">从表样式看起来非常简单，主要是对营业部进行分组，同时对资产进行分段即可完成报表。</span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;"><img src="http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=c9fcdf16-1ce1-430e-8b86-a49f99847d45" alt="" width="510" height="164" /></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">2.3<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">性能问题</span></span></h2> 
  <p class="MsoListParagraph" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;">后期用户对性能进行跟踪测试的结果：</span></p> 
  <table class="MsoNormalTable" style="width: 437.4pt; border-collapse: collapse;" border="1" cellspacing="0" cellpadding="0" width="583"> 
   <tbody> 
    <tr> 
     <td style="padding-right: 5.4pt; padding-left: 5.4pt; padding-bottom: 0cm; width: 87pt; padding-top: 0cm; border: windowtext 1pt solid;" width="116" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;">汇总数据量</span></p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: windowtext 1pt solid; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 89.4pt; padding-top: 0cm; border-bottom: windowtext 1pt solid;" width="119" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;">总数据量</span></p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: windowtext 1pt solid; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 261pt; padding-top: 0cm; border-bottom: windowtext 1pt solid;" width="348" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">Web</span><span style="font-family: 宋体; font-size: 12pt;">方式</span></span></p> </td> 
    </tr> 
    <tr> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: windowtext 1pt solid; width: 87pt; padding-top: 0cm; border-bottom: windowtext 1pt solid;" width="116" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">65</span><span style="font-family: 宋体; font-size: 12pt;">万</span></span></p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 89.4pt; padding-top: 0cm; border-bottom: windowtext 1pt solid;" width="119" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">65</span><span style="font-family: 宋体; font-size: 12pt;">万</span></span></p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 261pt; padding-top: 0cm; border-bottom: windowtext 1pt solid;" width="348" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">112</span><span style="font-family: 宋体; font-size: 12pt;">秒</span></span></p> </td> 
    </tr> 
    <tr style="height: 1.8pt;"> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: windowtext 1pt solid; width: 87pt; padding-top: 0cm; border-bottom: windowtext 1pt solid; height: 1.8pt;" rowspan="2" width="116" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">130</span><span style="font-family: 宋体; font-size: 12pt;">万</span></span></p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 89.4pt; padding-top: 0cm; border-bottom: windowtext 1pt solid; height: 1.8pt;" width="119" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">130</span><span style="font-family: 宋体; font-size: 12pt;">万</span></span></p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 261pt; padding-top: 0cm; border-bottom: windowtext 1pt solid; height: 1.8pt;" width="348" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">7</span><span style="font-family: 宋体; font-size: 12pt;">分</span><span style="font-family: 宋体; font-size: 12pt;">30</span><span style="font-family: 宋体; font-size: 12pt;">秒以后出现</span><span style="font-family: 宋体; color: red; font-size: 12pt;">内存占用太多，无法正常计算报表</span></span></p> </td> 
    </tr> 
    <tr style="height: 1.55pt;"> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 89.4pt; padding-top: 0cm; border-bottom: windowtext 1pt solid; height: 1.55pt;" width="119" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;">&nbsp;</p> </td> 
     <td style="border-right: windowtext 1pt solid; padding-right: 5.4pt; border-top: medium none; padding-left: 5.4pt; padding-bottom: 0cm; border-left: medium none; width: 261pt; padding-top: 0cm; border-bottom: windowtext 1pt solid; height: 1.55pt;" width="348" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;">&nbsp;</p> </td> 
    </tr> 
   </tbody> 
  </table> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">增加内存后，报表能正常显示，不过数据库运算时间，报表运算时间都在</span>20s<span style="font-family: 宋体; font-size: 12pt;">左右，离用户的需求还是有不小差距。</span></span></p> 
  <p class="MsoListParagraph" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;"><img src="http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=3f4c426a-643b-400e-a4c3-94b7bb08a442" alt="" width="554" height="231" /></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm; tab-stops: list 32.75pt;"><span style="font-size: 12pt;">3.<span style="font: 12pt 宋体;"> </span><span style="font-family: 宋体; font-size: 12pt;">解决方案</span></span></h2> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">3.1<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">问题分析</span></span></h2> 
  <p class="MsoListParagraph" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">在报表设计时，采取把数据一次提前到报表内存中运运算，</span> <span style="font-family: 宋体; font-size: 12pt;">当查询出来的数据量超过一定的范围（本案例中为</span>32<span style="font-family: 宋体; font-size: 12pt;">万条）时，就会导致内存不够使用，报表查询效率比较低。</span></span></p> 
  <p class="MsoListParagraph" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">根据报表本身不复杂，只要调整</span>sql<span style="font-family: 宋体; font-size: 12pt;">，让涉及到数据的汇总，放到</span>case<span style="font-family: 宋体; font-size: 12pt;">中实现，报表本身只是做数据的展现，页面汇总，百分比等运算。</span></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">3.2<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">调整后的</span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">sql</span></span></h2> 
  <table class="MsoNormalTable" style="border-collapse: collapse;" border="1" cellspacing="0" cellpadding="0"> 
   <tbody> 
    <tr style="height: 233.4pt;"> 
     <td style="padding-right: 5.4pt; padding-left: 5.4pt; padding-bottom: 0cm; width: 426.1pt; padding-top: 0cm; height: 233.4pt; border: black 1pt solid;" width="568" valign="top"> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">SELECT</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> JGID, </span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">COUNT</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(khid) </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum0,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">COUNT</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(DECODE(ZB158,</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">’1′</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">,</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">1</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">,</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">NULL</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">)) </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum1,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">10000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">1</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum2,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">10000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum3,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">5000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">10000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">1</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum4,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">5000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">10000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum5,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">3000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">5000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">1</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum6,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">3000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">5000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum7,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">500000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">3000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">1</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum8,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;=</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">500000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">3000000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum9,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">500000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">1</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">)</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum10,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&lt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">500000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB229 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">)</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum11,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">500000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB01 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">)</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum12,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">case</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">when</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (ZB229&gt;</span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">500000</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"></span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">then</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ZB27 </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">else</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: blue; font-size: 12pt;">0</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">end</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">)</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum13,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(ZB01) </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum14,</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">sum</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">(ZB27)</span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">as</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> sum15</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">FROM</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> T_ZB_KH_Y</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">WHERE</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> NY =? </span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">and</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> (JGID = ? </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">or</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> ? </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">is</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">null</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;">)</span></span></p> <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">group</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> </span><span style="font-family: 宋体; background: white; color: teal; font-size: 12pt;">by</span><span style="font-family: 宋体; background: white; color: navy; font-size: 12pt;"> JGID</span></span></p> </td> 
    </tr> 
   </tbody> 
  </table> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">3.3<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">调整后的报表设计</span></span></h2> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;"><img src="http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=a827832a-82c2-423b-b25a-a743c9a146ed" alt="" width="620" height="233" /></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm;"><span style="font-size: 12pt;"><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">3.4<span style="font: 12pt 宋体;"> </span></span><span style="line-height: 150%; font-family: 宋体; font-size: 12pt;">调整后的性能表现</span></span></h2> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-family: 宋体; font-size: 12pt;"><img src="http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=7afd766d-42e7-4a71-936e-0c6423e54b11" alt="" width="553" height="503" /></span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">根据日志，调整后，同样</span>250<span style="font-family: 宋体; font-size: 12pt;">万数据量下，数据库的查询时间耗费</span>2<span style="font-family: 宋体; font-size: 12pt;">秒，报表运算耗费时间</span>1<span style="font-family: 宋体; font-size: 12pt;">秒，能满足用户的具体需求。</span></span></p> 
  <h2 style="text-indent: 0cm; margin-left: 0cm; tab-stops: list 32.75pt;"><span style="font-size: 12pt;">4.<span style="font: 12pt 宋体;"> </span><span style="font-family: 宋体; font-size: 12pt;">总结</span></span></h2> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">分段函数</span>plot<span style="font-family: 宋体; font-size: 12pt;">，需要避免在</span> <span style="font-family: 宋体; font-size: 12pt;">数据集查询数据量比较大时，做全表扫描操作。</span></span></p> 
  <p class="MsoNormal" style="text-align: left; line-height: 1.5;"><span style="font-size: 12pt;"><span style="font-family: 宋体; font-size: 12pt;">把对数据库的汇总，分组在数据库层面进行，这样</span>sql<span style="font-family: 宋体; font-size: 12pt;">本身的运算，数据的传输，报表的运算效率都能得到一定程度的提高。</span></span></p>  
 </body>
</html>