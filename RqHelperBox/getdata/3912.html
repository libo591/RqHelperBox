<html>
 <head></head> 
 <body> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span>问题背景<span> </span></span></strong></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span><span><br /> </span></span></strong><span>&nbsp;&nbsp;&nbsp; 由于用户对百度或</span><span>google</span><span>搜索的使用习惯，想使用润乾报表实现一个类似站内搜索的功能</span><span>,</span><span>要求在参数模板查询的文本框里</span><span>,</span><span>根据输入的关键字</span><span>,</span><span>能够实现基于动态搜索提示</span><span>,</span><span>类似百度、</span><span>google,</span><span>默认取排名前</span><span>10</span><span>条信息</span><span>,</span><span>根据输入关键字自动提示、支持键盘下移回车等操作。</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>&nbsp;&nbsp;&nbsp; 以下内容是以数据库表的关键字段为数据来源的实例场景。</span><span>&nbsp;</span></p> 
  <p><strong><span><span>&nbsp;&nbsp;&nbsp;</span></span></strong><strong><span>实例演示一&nbsp;</span></strong><span><br /> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>1.</span><span>数据的来源以数据库</span><span>EMPLOYEE</span><span>表为例</span><span>,</span><span>提取所有</span><span>EMPNAME</span><span>信息</span><span>:<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/1c6ac859-adca-4f19-8530-d1a2a5b46265.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=074157c2-5f95-419d-b251-0e3bceb8183b" width="482" height="460" /></span></span></p> 
  <p><span>&nbsp;&nbsp;&nbsp; </span>2.<span>点击参数模板文本框</span><span>,</span><span>自动从数据库提取前</span><span>10</span><span>条信息</span><span>,</span><span>作为参数查询条件</span><span><br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/36f9ad3d-c766-43d0-813e-d4301417086f.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=4dcaf627-5d59-4d03-a4c1-5451f44781ed" width="396" height="369" /></span></span></p> 
  <p><span>&nbsp;&nbsp;&nbsp; </span>3.<span>输入关键字</span><span>,</span><span>会自动过滤掉不想要的信息</span><span>.<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/ac3c0dbe-a903-4bd8-b6ae-eb01e849f4e7.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=7d5d48c4-02ee-4535-9f9b-4344838861c5" width="719" height="286" /></span><br /> <span>&nbsp;&nbsp;&nbsp; </span>4. </span><span>当输入的关键字</span><span>,</span><span>过滤的结果比较多的时候</span><span>,</span><span>默认提取排名前</span><span>10</span><span>条信息</span><span>.<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/607f4b34-b73f-4f8b-bc3a-bbc017d4686e.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=94842cec-a099-44b4-8094-af8c50267f31" width="719" height="365" /></span><br /> <span>&nbsp;&nbsp;&nbsp; </span>5.</span><span>选择要查询的参数</span><span>,</span><span>根据具体参数值查询出相应的结果</span><span>.<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/49149a1c-0e32-4a9e-b1de-948c5874855c.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=8a7dd2d3-0f8c-4532-abad-5996d7c1f38c" width="698" height="327" /></span></span></p> 
  <p><span>&nbsp;&nbsp;&nbsp; </span>5. <span>参数模板的设计：</span><span><br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/c9c8d2df-5b86-46fd-be0a-56d8a51e8f83.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=d8b10c39-237e-4f2e-9a90-b606b46866f8" width="826" height="272" /></span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white; margin-left: 23.5pt;"><strong></strong>&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white; margin-left: 23.5pt;"><strong><span>实例演示二<span><br /> </span></span></strong><span>1.</span><span>在系统站内实现</span><span>,</span><span>数据的来源以数据库</span><span>EMPLOYEE</span><span>表为例</span><span>,</span><span>提取所有</span><span>EMPNAME</span><span>信息</span><span>:<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/901ab0d9-c73d-47d8-ad4c-25a4037ead60.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=03e824b6-5235-476a-b70d-f0fe91ed9a51" width="559" height="201" /></span><br /> 2. </span><span>当输入的关键字</span><span>,</span><span>过滤的结果比较多的时候</span><span>,</span><span>默认提取排名前</span><span>10</span><span>条信息</span><span></span><span>带结果提示</span><span><br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/d8ed82a1-040c-4df7-823b-fa618818d7e1.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=91ea12a7-b81b-451b-9ae5-d1242787b0d7" width="536" height="387" /></span><br /> 3. </span><span>输入关键字</span><span>,</span><span>会自动过滤掉不想要的信息</span><span>.</span><span>带结果提示</span><span><br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/444a3c47-b1d0-4e0d-b500-521c2357684d.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=104e1b69-8dc3-40cb-adb6-561e7eee7c09" width="545" height="228" /></span></span></p> 
  <p class="MsoNormal" style="text-align: left; text-indent: -18pt; background: white; margin-left: 18pt;"><span><br /> </span><strong><span>实例演示三<span><br /> </span></span></strong><span>1.</span><span>在系统站内实现</span><span>,</span><span>数据的来源以数据库</span><span>EMPLOYEE</span><span>表为例</span><span>,</span><span>提取所有</span><span>EMPNAME</span><span>信息</span><span>:<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/bf9e08e2-0bb7-47b7-8cde-950d8c94a2da.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=63ecc615-d59b-411f-b55c-658d7a7e4fb4" width="542" height="221" /></span><br /> <span>&nbsp;&nbsp;&nbsp;&nbsp; </span>2. </span><span>当输入的关键字</span><span>,</span><span>过滤的结果比较多的时候</span><span>,</span><span>默认提取排名前</span><span>10</span><span>条信息</span><span>.<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/c50855e4-f3db-4ce9-849e-17dba0296e9b.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=f7ca185e-52ad-4c80-95e3-4e52d0699239" width="586" height="416" /></span><br /> <span>&nbsp;&nbsp; </span>3. </span><span>输入关键字</span><span>,</span><span>会自动过滤掉不想要的信息</span><span>.<br /> <span><img src="an.com.cn/wp-content/uploads/2011/07/c216be3a-a4e8-41f5-b676-1e9ea8ae32be.jpg" alt="说明: http://192.168.0.6/reportmis/mis2/reportcenter/ewebeditor/imgServlet?fileID=8c3675f3-c5b3-4eb9-9b05-2324cac5e44e" width="560" height="247" /></span></span></p> 
  <p><span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"> <strong><span>基本思路</span></strong></p> 
  <p></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span><span><br /> </span></span></strong><span>1.</span><span>从数据库表提取站内搜索关键字段的信息</span><span><br /> 2.</span><span>在参数模板里定义文本框为</span><span>HTML</span><span>类型</span><span>,</span><span>定义</span><span>DIV</span><span>层</span><span><br /> 3.</span><span>利用雅虎的</span><span>javascript</span><span>搜索及</span><span>CSS</span><span>框架</span><span>,</span><span>在此基础上对数据进行二次封装</span><span><br /> </span><span>（<span style="color: blue;">关于框架可在网上搜索</span>）</span><span> </span></p> 
  <p><span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"> <strong><span>实现方式</span></strong></p> 
  <p></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong></strong>&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>关键性程序说明：</span><span><br /> 1.</span><span>执行数据库管理（打开关闭连接</span><span>,</span><span>执行增删改查）</span><span>,DBManager.java</span><span>代码：</span><span> </span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">package</span></strong><span style="color: black;"> org.xaccp.bar;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.CallableStatement;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.Connection;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.DriverManager;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.PreparedStatement;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.ResultSet;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.SQLException;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.Statement;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">class</span></strong><span style="color: black;"> DBManager {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">final</span></strong><span style="color: black;"> String </span><em><span style="color: #0000c0;">DRIVERNAME</span></em><span style="color: black;"> = </span><span style="color: #2a00ff;">“com.newatlanta.jturbo.driver.Driver”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">final</span></strong><span style="color: black;"> String </span><em><span style="color: #0000c0;">URL</span></em><span style="color: black;"> = </span><span style="color: #2a00ff;">“jdbc:JTurbo://127.0.0.1/DBA/charset=GBK”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">final</span></strong><span style="color: black;"> String </span><em><span style="color: #0000c0;">UID</span></em><span style="color: black;"> = </span><span style="color: #2a00ff;">“sa”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">final</span></strong><span style="color: black;"> String </span><em><span style="color: #0000c0;">PWD</span></em><span style="color: black;"> = </span><span style="color: #2a00ff;">“sa”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">private</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> DBManager </span><em><span style="color: #0000c0;">manager</span></em><span style="color: black;"> = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> DBManager();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">private</span></strong><span style="color: black;"> Connection </span><span style="color: #0000c0;">conn</span><span style="color: black;"> = </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> DBManager() {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">try</span></strong><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; openConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="color: #7f0055;">catch</span></strong><span style="color: black;"> (ClassNotFoundException e) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="color: #7f0055;">catch</span></strong><span style="color: black;"> (SQLException e) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">单例模式</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> DBManager getInstance() {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> </span><em><span style="color: #0000c0;">manager</span></em><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">打开连接</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">void</span></strong><span style="color: black;"> openConnection() </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> ClassNotFoundException, SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">try</span></strong><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Class.<em>forName</em>(</span><em><span style="color: #0000c0;">DRIVERNAME</span></em><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #0000c0;">conn</span><span style="color: black;"> = DriverManager.<em>getConnection</em>(</span><em><span style="color: #0000c0;">URL</span></em><span style="color: black;"></span><em><span style="color: #0000c0;">UID</span></em><span style="color: black;"></span><em><span style="color: #0000c0;">PWD</span></em><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="color: #7f0055;">catch</span></strong><span style="color: black;"> (Exception e) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">执行增删改</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">void</span></strong><span style="color: black;"> executeUpdate(String strSql) </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Statement stat = </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.createStatement();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stat.executeUpdate(strSql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">执行查询</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> ResultSet executeQuerry(String strSql) </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Statement stat = </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.createStatement();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> stat.executeQuery(strSql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">关闭连接</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">void</span></strong><span style="color: black;"> closeConnection() </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;"> == </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">)</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (!(</span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.isClosed())) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.close();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;"> = </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">自行存储过程</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> CallableStatement getCallableStatement(String proc)</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.prepareCall(proc);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> PreparedStatement getpreParedstatement(String strsql)</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PreparedStatement pstat = </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.prepareStatement(strsql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> pstat;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">返回结果集</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> ResultSet getstatement(String strsql) </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Statement stat = </span><strong><span style="color: #7f0055;">this</span></strong><span style="color: black;">.</span><span style="color: #0000c0;">conn</span><span style="color: black;">.createStatement();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResultSet rs = stat.executeQuery(strsql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> rs;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">}</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>2.</span><span>执行</span><span>SQL</span><span>语句</span><span>,</span><span>提取查询结果</span><span>,</span><span>字符格式转换等</span><span>,<span style="color: black;">ReportFunDAO.java</span></span><span style="color: black;">代码：</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">package</span></strong><span style="color: black;"> org.xaccp.bar;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.ResultSet;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.sql.SQLException;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.util.ArrayList;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">import</span></strong><span style="color: black;"> java.util.List;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">/**</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;</span><span style="color: #3f5fbf;">*</span><span style="color: black;"> </span><span style="color: #3f5fbf;">查询关键字信息</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;</span><span style="color: #3f5fbf;">*</span><span style="color: black;"> </span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;</span><span style="color: #3f5fbf;">*</span><span style="color: black;"> </span><strong><span style="color: #7f9fbf;">@param</span></strong><span style="color: black;"> </span><span style="color: #3f5fbf;">可自行加入一些条件</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;</span><span style="color: #3f5fbf;">*</span><span style="color: black;"> </span><strong><span style="color: #7f9fbf;">@return</span></strong><span style="color: black;"> </span><span style="color: #3f5fbf;">List</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;</span><span style="color: #3f5fbf;">*/</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">class</span></strong><span style="color: black;"> ReportFunDAO {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">查询所有记录</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> String resResult() </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException,</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ClassNotFoundException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; areaList = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> ArrayList&lt;String&gt;();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = </span><span style="color: #2a00ff;">“”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String sql = </span><span style="color: #2a00ff;">“SELECT EMPNAME FROM EMPLOYEE”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DBManager dbm = DBManager.<em>getInstance</em>();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbm.openConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResultSet rs = dbm.executeQuerry(sql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">while</span></strong><span style="color: black;"> (rs.next()) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strResult = rs.getString(1).trim();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; areaList.add(strResult);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = <em>stringTransfer</em>(areaList);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbm.closeConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> str;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">根据</span><span style="color: #3f7f5f;">Name,ID</span><span style="color: #3f7f5f;">查询</span><span style="color: #3f7f5f;">top 10</span><span style="color: #3f7f5f;">记录</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> String resNameResult(String strInit) </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException,</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ClassNotFoundException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strInit = strInit == </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;"> ? </span><span style="color: #2a00ff;">“”</span><span style="color: black;"> : strInit;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Map&lt;String, String&gt; hashMap = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> HashMap&lt;String, String&gt;();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = </span><span style="color: #2a00ff;">“”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String sql = </span><span style="color: #2a00ff;">“SELECT top 10 EMPNAME,EMPID FROM EMPLOYEE WHERE EMPNAME LIKE ‘%”</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + strInit + </span><span style="color: #2a00ff;">“%’”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><em><span style="color: #0000c0;">out</span></em><span style="color: black;">.println(</span><span style="color: #2a00ff;">“SQL</span><span style="color: #2a00ff;">语句</span><span style="color: #2a00ff;">:”</span><span style="color: black;"> + sql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DBManager dbm = DBManager.<em>getInstance</em>();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbm.openConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResultSet rs = dbm.executeQuerry(sql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">boolean</span></strong><span style="color: black;"> is = </span><strong><span style="color: #7f0055;">false</span></strong><span style="color: black;">;</span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">判断行数是否为空</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">while</span></strong><span style="color: black;"> (rs.next()) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is = </span><strong><span style="color: #7f0055;">true</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strResult1 = rs.getString(1).trim();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strResult2 = rs.getString(2).trim();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hashMap.put(strResult1, strResult2);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = <em>stringTransfer2</em>(hashMap, strInit, is);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbm.closeConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> str;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">根据</span><span style="color: #3f7f5f;">Name</span><span style="color: #3f7f5f;">查询</span><span style="color: #3f7f5f;">top 10</span><span style="color: #3f7f5f;">记录</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> String resNameResult2(String strInit) </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> SQLException,</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ClassNotFoundException {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strInit = strInit == </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;"> ? </span><span style="color: #2a00ff;">“”</span><span style="color: black;"> : strInit;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = </span><span style="color: #2a00ff;">“”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; areaList = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> ArrayList&lt;String&gt;();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String sql = </span><span style="color: #2a00ff;">“SELECT top 10 EMPNAME FROM EMPLOYEE WHERE EMPNAME LIKE ‘%”</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + strInit + </span><span style="color: #2a00ff;">“%’”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><em><span style="color: #0000c0;">out</span></em><span style="color: black;">.println(</span><span style="color: #2a00ff;">“SQL</span><span style="color: #2a00ff;">语句</span><span style="color: #2a00ff;">:”</span><span style="color: black;"> + sql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DBManager dbm = DBManager.<em>getInstance</em>();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbm.openConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResultSet rs = dbm.executeQuerry(sql);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">boolean</span></strong><span style="color: black;"> is = </span><strong><span style="color: #7f0055;">false</span></strong><span style="color: black;">;</span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">判断行数是否为空</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">while</span></strong><span style="color: black;"> (rs.next()) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is = </span><strong><span style="color: #7f0055;">true</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strResult = rs.getString(1).trim();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; areaList.add(strResult);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = <em>stringTransfer3</em>(areaList, strInit, is);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><em><span style="color: #0000c0;">out</span></em><span style="color: black;">.println(</span><span style="color: #2a00ff;">“str:”</span><span style="color: black;"> + str);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dbm.closeConnection();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> str;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// d1,d2,d3 –&gt; ‘d1′,’d2′,’d3′</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> String stringTransfer(List&lt;String&gt; strInit) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strResult = </span><span style="color: #2a00ff;">“”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> i = 0; i &lt; strInit.size(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strResult += </span><span style="color: #2a00ff;">“‘”</span><span style="color: black;"> + strInit.get(i) + </span><span style="color: #2a00ff;">“‘,”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strResult = strResult.substring(0, strResult.length() – 1);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> strResult;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">格式</span><span style="color: #3f7f5f;">:compResp(“1234″, new Array(“1234</span><span style="color: #3f7f5f;">歌</span><span style="color: #3f7f5f;">“), new Array(“93 </span><span style="color: #3f7f5f;">结果</span><span style="color: #3f7f5f;">“));</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> String stringTransfer2(Map&lt;String, String&gt; params,</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strInit, </span><strong><span style="color: #7f0055;">boolean</span></strong><span style="color: black;"> is) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String s = </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (is) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set&lt;?&gt; entrySet = params.entrySet();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuffer str = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> StringBuffer();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;String&gt; sqls = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> ArrayList&lt;String&gt;();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“compResp(‘”</span><span style="color: black;"> + strInit + </span><span style="color: #2a00ff;">“‘, new Array(“</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (Iterator&lt;?&gt; ite = entrySet.iterator(); ite.hasNext();) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Entry&lt;?, ?&gt; entry = (Entry&lt;?, ?&gt;) ite.next();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Object objectKey = entry.getKey().toString();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Object objectValue = entry.getValue();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sqls.add(objectValue.toString());</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“‘”</span><span style="color: black;"> + objectKey + </span><span style="color: #2a00ff;">“‘”</span><span style="color: black;">).append(</span><span style="color: #2a00ff;">“,”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.deleteCharAt(str.length() – 1);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“), new Array(“</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (String ss : sqls) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“‘”</span><span style="color: black;"> + ss + </span><span style="color: #2a00ff;"></span><span style="color: #2a00ff;">结果</span><span style="color: #2a00ff;">‘”</span><span style="color: black;">).append(</span><span style="color: #2a00ff;">“,”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s = str.toString();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (s.endsWith(</span><span style="color: #2a00ff;">“,”</span><span style="color: black;">))</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s = s.substring(0, s.length() – </span><span style="color: #2a00ff;">“,”</span><span style="color: black;">.length());</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s += </span><span style="color: #2a00ff;">“))”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="color: #7f0055;">else</span></strong><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuffer str = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> StringBuffer();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“compResp(‘”</span><span style="color: black;"> + strInit</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + </span><span style="color: #2a00ff;">“‘, new Array(‘NO’), new Array(‘NO’))”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; s = str.toString();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> s;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">格式</span><span style="color: #3f7f5f;">:”window.sogou.sug(['2',['2144</span><span style="color: #3f7f5f;">小游戏</span><span style="color: #3f7f5f;">','2011</span><span style="color: #3f7f5f;">高考作文</span><span style="color: #3f7f5f;">','2011</span><span style="color: #3f7f5f;">高考</span><span style="color: #3f7f5f;">','2011</span><span style="color: #3f7f5f;">高考语文试卷</span><span style="color: #3f7f5f;">','2020','2011</span><span style="color: #3f7f5f;">高考作文题</span><span style="color: #3f7f5f;">','2345','2011</span><span style="color: #3f7f5f;">高考试卷</span><span style="color: #3f7f5f;">','2011</span><span style="color: #3f7f5f;">高考语文</span><span style="color: #3f7f5f;">','2144']],-1);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> String stringTransfer3(List&lt;String&gt; strInit, String s,</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">boolean</span></strong><span style="color: black;"> is) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String $s = </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (is) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strResult = </span><span style="color: #2a00ff;">“”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuffer str = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> StringBuffer();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“window.sogou.sug(['&quot;</span><span style="color: black;">).append(s).append(</span><span style="color: #2a00ff;">&quot;',[&quot;</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> i = 0; i &lt; strInit.size(); i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strResult += </span><span style="color: #2a00ff;">&quot;'&quot;</span><span style="color: black;"> + strInit.get(i) + </span><span style="color: #2a00ff;">&quot;',&quot;</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strResult = strResult.substring(0, strResult.length() - 1);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(strResult).append(</span><span style="color: #2a00ff;">&quot;]],-1);”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str.toString();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="color: #7f0055;">else</span></strong><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuffer str = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> StringBuffer();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.append(</span><span style="color: #2a00ff;">“window.sogou.sug(['&quot;</span><span style="color: black;">).append(s).append(</span><span style="color: #2a00ff;">&quot;',['']],-1);”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $s = str.toString();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> $s;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">static</span></strong><span style="color: black;"> </span><strong><span style="color: #7f0055;">void</span></strong><span style="color: black;"> main(String[] args) </span><strong><span style="color: #7f0055;">throws</span></strong><span style="color: black;"> Exception {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">// String fBtnLst = resResult();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String s = <em>resNameResult2</em>(</span><span style="color: #2a00ff;">“</span><span style="color: #2a00ff;">小</span><span style="color: #2a00ff;">“</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><em><span style="color: #0000c0;">out</span></em><span style="color: black;">.println(</span><span style="color: #2a00ff;">“html:”</span><span style="color: black;"> + s);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">}</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>3.</span><span>展示加载数据</span><span>JS</span><span>等</span><span>, showReport2.jsp</span><span>代码：</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #bf5f3f;">&lt;%@ </span><span style="color: #3f7f7f;">page </span><span style="color: #7f007f;">contentType</span><span style="color: black;">=</span><span style="color: #2a00ff;">“text/html;charset=GBK”</span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #bf5f3f;">&lt;%@ </span><span style="color: #3f7f7f;">taglib </span><span style="color: #7f007f;">uri</span><span style="color: black;">=</span><span style="color: #2a00ff;">“/WEB-INF/runqianReport4.tld” </span><span style="color: #7f007f;">prefix</span><span style="color: black;">=</span><span style="color: #2a00ff;">“report”</span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #bf5f3f;">&lt;%@ </span><span style="color: #3f7f7f;">page </span><span style="color: #7f007f;">import</span><span style="color: black;">=</span><span style="color: #2a00ff;">“java.io.*”</span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #bf5f3f;">&lt;%@ </span><span style="color: #3f7f7f;">page </span><span style="color: #7f007f;">import</span><span style="color: black;">=</span><span style="color: #2a00ff;">“java.util.*”</span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #bf5f3f;">&lt;%@ </span><span style="color: #3f7f7f;">page </span><span style="color: #7f007f;">import</span><span style="color: black;">=</span><span style="color: #2a00ff;">“com.runqian.report4.usermodel.Context”</span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #bf5f3f;">&lt;%@</span><span style="color: #3f7f7f;">page </span><span style="color: #7f007f;">import</span><span style="color: black;">=</span><span style="color: #2a00ff;">“org.xaccp.bar.ReportFunDAO;”</span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">html</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;"></span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">head</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp; &nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">title</span><span style="color: teal;">&gt;</span><span style="color: black;">全文搜索</span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">title</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp; &nbsp; </span><span style="color: #3f5fbf;">&lt;!–</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp; &nbsp; &lt;link rel=”stylesheet” type=”text/css” href=”</span><span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">request.getContextPath()</span><span style="color: #bf5f3f;">%&gt;</span><span style="color: #3f5fbf;">/css/fonts-min.css” /&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; &lt;link rel=”stylesheet” type=”text/css” href=”</span><span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">request.getContextPath()</span><span style="color: #bf5f3f;">%&gt;</span><span style="color: #3f5fbf;">/css/autocomplete.css” /&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; &nbsp;–&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">script </span><span style="color: #7f007f;">type</span><span style="color: black;">=</span><span style="color: #2a00ff;">“text/javascript” </span><span style="color: #7f007f;">src</span><span style="color: black;">=</span><span>“<span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">request.getContextPath()</span><span style="color: #bf5f3f;">%&gt;</span><span style="color: #2a00ff;">/js/yahoo-dom-event.js</span>“<span style="color: teal;">&gt;&lt;/</span><span style="color: #3f7f7f;">script</span><span style="color: teal;">&gt;</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">script </span><span style="color: #7f007f;">type</span><span style="color: black;">=</span><span style="color: #2a00ff;">“text/javascript” </span><span style="color: #7f007f;">src</span><span style="color: black;">=</span><span>“<span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">request.getContextPath()</span><span style="color: #bf5f3f;">%&gt;</span><span style="color: #2a00ff;">/js/animation.js</span>“<span style="color: teal;">&gt;&lt;/</span><span style="color: #3f7f7f;">script</span><span style="color: teal;">&gt;</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">script </span><span style="color: #7f007f;">type</span><span style="color: black;">=</span><span style="color: #2a00ff;">“text/javascript” </span><span style="color: #7f007f;">src</span><span style="color: black;">=</span><span>“<span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">request.getContextPath()</span><span style="color: #bf5f3f;">%&gt;</span><span style="color: #2a00ff;">/js/autocomplete.js</span>“<span style="color: teal;">&gt;&lt;/</span><span style="color: #3f7f7f;">script</span><span style="color: teal;">&gt;</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">style </span><span style="color: #7f007f;">type</span><span style="color: black;">=</span><span style="color: #2a00ff;">“text/css”</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f7f7f;">#statesautocomplete,#statesautocomplete2</span><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>&nbsp;&nbsp;&nbsp; <span style="color: #7f007f;">width</span><span style="color: black;"></span><span style="color: #2a00e1;">10em</span><span style="color: black;"></span><span style="color: #3f5fbf;"></span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>&nbsp;&nbsp;&nbsp; <span style="color: #7f007f;">padding-bottom</span><span style="color: black;"></span><span style="color: #2a00e1;">1.5em</span><span style="color: black;">;</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">}</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f7f7f;">#statesautocomplete</span><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>&nbsp;&nbsp;&nbsp; <span style="color: #7f007f;">z-index</span><span style="color: black;"></span><span style="color: #2a00e1;">9000</span><span style="color: black;">;</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>&nbsp;&nbsp;&nbsp; <span style="color: #3f5fbf;"></span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">}</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f7f7f;">#statesinput,#statesinput2</span><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span>&nbsp;&nbsp;&nbsp; <span style="color: #7f007f;">_position</span><span style="color: black;"></span><span style="color: #2a00e1;">absolute</span><span style="color: black;"></span><span style="color: #3f5fbf;"></span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">}&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">head</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">body </span><span style="color: #7f007f;">topmargin</span><span style="color: black;">=</span><span style="color: #2a00ff;"></span><span style="color: #7f007f;">leftmargin</span><span style="color: black;">=</span><span style="color: #2a00ff;"></span><span style="color: #7f007f;">rightmargin</span><span style="color: black;">=</span><span style="color: #2a00ff;"></span><span style="color: #7f007f;">bottomMargin</span><span style="color: black;">=</span><span style="color: #2a00ff;"></span><span style="color: #7f007f;">class</span><span style="color: black;">=</span><span style="color: #2a00ff;">“yui-skin-sam”</span><span style="color: teal;">&gt;</span><span style="color: black;">&nbsp;&nbsp; </span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">&lt;%</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.setCharacterEncoding(</span><span style="color: #2a00ff;">“GBK”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String report = request.getParameter(</span><span style="color: #2a00ff;">“raq”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String reportFileHome = Context.getInitCtx().getMainDir();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuffer param = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> StringBuffer();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">保证报表名称的完整性</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> iTmp = 0;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> ((iTmp = report.lastIndexOf(</span><span style="color: #2a00ff;">“.raq”</span><span style="color: black;">)) &lt;= 0) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; report = report + </span><span style="color: #2a00ff;">“.raq”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iTmp = 0;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Enumeration paramNames = request.getParameterNames();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (paramNames != </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">while</span></strong><span style="color: black;"> (paramNames.hasMoreElements()) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String paramName = (String) paramNames.nextElement();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String paramValue = request.getParameter(paramName);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (paramValue != </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">把参数拼成</span><span style="color: #3f7f5f;">name=value;name2=value2;…..</span><span style="color: #3f7f5f;">的形式</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; param.append(paramName).append(</span><span style="color: #2a00ff;">“=”</span><span style="color: black;">).append(paramValue)</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .append(</span><span style="color: #2a00ff;">“;”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">以下代码是检测这个报表是否有相应的参数模板</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String paramFile = report.substring(0, iTmp) + </span><span style="color: #2a00ff;">“_arg.raq”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File f = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> File(application.getRealPath(reportFileHome</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + File.separator + paramFile));</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">jsp:include </span><span style="color: #7f007f;">page</span><span style="color: black;">=</span><span style="color: #2a00ff;">“toolbar.jsp” </span><span style="color: #7f007f;">flush</span><span style="color: black;">=</span><span style="color: #2a00ff;">“false” </span><span style="color: teal;">/&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">table </span><span style="color: #7f007f;">id</span><span style="color: black;">=</span><span style="color: #2a00ff;">rpt </span><span style="color: #7f007f;">align</span><span style="color: black;">=</span><span style="color: #2a00ff;">center</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">tr</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">&lt;%</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #3f7f5f;">//</span><span style="color: #3f7f5f;">如果参数模板存在，则显示参数模板</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (f.exists()) {</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">table </span><span style="color: #7f007f;">id</span><span style="color: black;">=</span><span style="color: #2a00ff;">param_tbl</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">tr</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">report:param </span><span style="color: #7f007f;">name</span><span style="color: black;">=</span><span style="color: #2a00ff;">“form1″ </span><span style="color: #7f007f;">paramFileName</span><span style="color: black;">=</span><span>“<span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">paramFile</span><span style="color: #bf5f3f;">%&gt;</span>“</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f007f;">needSubmit</span><span style="color: black;">=</span><span style="color: #2a00ff;">“no” </span><span style="color: #7f007f;">params</span><span style="color: black;">=</span><span>“<span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">param.toString()</span><span style="color: #bf5f3f;">%&gt;</span>“<span style="color: black;"> </span><span style="color: teal;">/&gt;</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;"></span><span style="color: #7f007f;">href</span><span style="color: black;">=</span><span style="color: #2a00ff;">“javascript:_submit( form1 )”</span><span style="color: teal;">&gt;&lt;</span><span style="color: #3f7f7f;">img</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f7f7f;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f007f;">src</span><span style="color: black;">=</span><span style="color: #2a00ff;">“../images/query.jpg” </span><span style="color: #7f007f;">border</span><span style="color: black;">=</span><span style="color: #2a00ff;">no</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #2a00ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f007f;">style</span><span style="color: black;">=</span><span style="color: #2a00ff;">“vertical-align: middle”</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">a</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">tr</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">table</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">&lt;%</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">table </span><span style="color: #7f007f;">align</span><span style="color: black;">=</span><span style="color: #2a00ff;">center</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">tr</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">report:html </span><span style="color: #7f007f;">name</span><span style="color: black;">=</span><span style="color: #2a00ff;">“report1″ </span><span style="color: #7f007f;">reportFileName</span><span style="color: black;">=</span><span>“<span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">report</span><span style="color: #bf5f3f;">%&gt;</span>“</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f007f;">funcBarLocation</span><span style="color: black;">=</span><span style="color: #2a00ff;">“” </span><span style="color: #7f007f;">needPageMark</span><span style="color: black;">=</span><span style="color: #2a00ff;">“yes”</span><span style="color: #7f007f;">&nbsp; generateParamForm</span><span style="color: black;">=</span><span style="color: #2a00ff;">“no”</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #2a00ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f007f;">needLinkStyle</span><span style="color: black;">=</span><span style="color: #2a00ff;">“yes” </span><span style="color: #7f007f;">params</span><span style="color: black;">=</span><span style="color: #2a00ff;">“</span><span style="color: #bf5f3f;">&lt;%=</span><span style="color: black;">param.toString()</span><span style="color: #bf5f3f;">%&gt;</span><span>“<span style="color: black;"> </span><span style="color: #7f007f;">width</span><span style="color: black;">=</span><span style="color: #2a00ff;">“-1″</span></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #2a00ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f007f;">exceptionPage</span><span style="color: black;">=</span><span style="color: #2a00ff;">“/reportJsp/myError2.jsp” </span><span style="color: teal;">/&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">td</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">tr</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">table</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">script </span><span style="color: #7f007f;">language</span><span style="color: black;">=</span><span style="color: #2a00ff;">“javascript”</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f5fbf;">//</span><span style="color: #3f5fbf;">设置分页显示值</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; </span><span style="color: black;">document.getElementById( </span><span style="color: #8e00ff;">“t_page_span” </span><span style="color: black;">).innerHTML=report1_getTotalPage();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; document.getElementById( </span><span style="color: #8e00ff;">“c_page_span” </span><span style="color: black;">).innerHTML=report1_getCurrPage();</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">script</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">&lt;%</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReportFunDAO funcBar = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> ReportFunDAO();&nbsp;&nbsp;&nbsp; </span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #bf5f3f;">%&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">table</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;"></span><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">body</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;"></span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;"></span><span style="color: teal;">&lt;</span><span style="color: #3f7f7f;">script </span><span style="color: #7f007f;">type</span><span style="color: black;">=</span><span style="color: #2a00ff;">“text/javascript”</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f5fbf;">//</span><span style="color: #3f5fbf;">加载数据库数据</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">YAHOO.example.statesArray = [</span><span style="color: #bf5f3f;">&lt;%</span><span style="color: black;">out.print(funcBar.resResult());</span><span style="color: #bf5f3f;">%&gt;</span><span style="color: black;">];</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">YAHOO.example.ACJSArray = </span><span style="color: #7f0055;">new function</span><span style="color: black;">() </span><span style="color: #7f0055;">{</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #7f0055;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f5fbf;">// Instantiate first JS Array DataSource</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oACDS = </span><span style="color: #7f0055;">new </span><span style="color: black;">YAHOO.widget.DS_JSArray(YAHOO.example.statesArray);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f5fbf;">// Instantiate first AutoComplete</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp = </span><span style="color: #7f0055;">new </span><span style="color: black;">YAHOO.widget.AutoComplete(</span><span style="color: #8e00ff;">‘key’</span><span style="color: black;">,</span><span style="color: #8e00ff;">‘statescontainer’</span><span style="color: black;"></span><span style="color: #7f0055;">this</span><span style="color: black;">.oACDS);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp.prehighlightClassName = </span><span style="color: #8e00ff;">“yui-ac-prehighlight”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp.typeAhead = </span><span style="color: #7f0055;">true</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp.useShadow = </span><span style="color: #7f0055;">true</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp.minQueryLength = 0;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp.textboxFocusEvent.subscribe(</span><span style="color: #7f0055;">function</span><span style="color: black;">()</span><span style="color: #7f0055;">{</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #7f0055;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var </span><span style="color: black;">sInputValue = YAHOO.util.Dom.get(</span><span style="color: #8e00ff;">‘key’</span><span style="color: black;">).value;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">if</span><span style="color: black;">(sInputValue.length === 0) </span><span style="color: #7f0055;">{</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #7f0055;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var </span><span style="color: black;">oSelf = </span><span style="color: #7f0055;">this</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setTimeout(</span><span style="color: #7f0055;">function</span><span style="color: black;">()</span><span style="color: #7f0055;">{</span><span style="color: black;">oSelf.sendQuery(sInputValue);</span><span style="color: #7f0055;">}</span><span style="color: black;">,0);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">}</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #7f0055;">&nbsp;&nbsp;&nbsp; }</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f5fbf;">// Instantiate second JS Array DataSource</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oACDS2 = </span><span style="color: #7f0055;">new </span><span style="color: black;">YAHOO.widget.DS_JSArray(YAHOO.example.areacodesArray);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #3f5fbf;">// Instantiate second AutoComplete</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #3f5fbf;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp2 = </span><span style="color: #7f0055;">new </span><span style="color: black;">YAHOO.widget.AutoComplete(</span><span style="color: #8e00ff;">‘statesinput2′</span><span style="color: black;">,</span><span style="color: #8e00ff;">‘statescontainer2′</span><span style="color: black;"></span><span style="color: #7f0055;">this</span><span style="color: black;">.oACDS2);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp2.prehighlightClassName = </span><span style="color: #8e00ff;">“yui-ac-prehighlight”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp2.typeAhead = </span><span style="color: #7f0055;">true</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp2.useShadow = </span><span style="color: #7f0055;">true</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp2.forceSelection = </span><span style="color: #7f0055;">true</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">this</span><span style="color: black;">.oAutoComp2.formatResult = </span><span style="color: #7f0055;">function</span><span style="color: black;">(oResultItem, sQuery) </span><span style="color: #7f0055;">{</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #7f0055;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var </span><span style="color: black;">sMarkup = oResultItem[0] + </span><span style="color: #8e00ff;">” (” </span><span style="color: black;">+ oResultItem[1] + </span><span style="color: #8e00ff;">“)”</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">return </span><span style="color: black;">(sMarkup);</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">&nbsp;&nbsp;&nbsp; </span><span style="color: #7f0055;">}</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: #7f0055;">}</span><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">script</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: teal;">&lt;/</span><span style="color: #3f7f7f;">html</span><span style="color: teal;">&gt;</span></p> 
  <p class="MsoNormal" style="text-align: left; background: white;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><strong><span>总结<span></span></span></strong></p> 
  <strong> </strong> 
  <p><strong></strong></p> 
  <p class="MsoNormal" style="text-align: left; background: white;"><span style="color: black;">集智数据平台内报表单元格提供的多种数据类型支持，帮助用户结合简单程序设计巧妙且轻松完成看似复杂，甚至不可能实现问题。</span></p> 
  <p></p>  
 </body>
</html>