<html>
 <head></head> 
 <body> 
  <div class="entry"> 
   <p>参数机制给报表设计带来了很大的灵活性，通过使用参数可以实现页面上的动态交互功能。然而，有时候仅仅有参数还是不够的，还需要更加灵活的宏机制。润乾报表的宏机制可以满足此类的需求。宏还分为普通宏和动态宏两种，动态宏可以预先进行运算，与参数机制结合就可以完成复杂的条件设置。</p> 
   <p>比如，一个查询订单的报表，通过设置参数模板可以在页面上实时选择想要的分组方式（按地区或按运货商），点击查询可以按照所选的方式进行分组。这时，在报表设计中就要用到宏机制。利用动态宏，来根据页面传过来的参数值进行不同的分组。更进一步的，在查询出的每个订单号后面加一个超链接，通过超链接把主页面中的宏传给子页面，并且在子页面中对传过来参数字段的值进行检索。也就是说，当选择按地区分组时，主页面中展现的是按地区的分组列表，点击每个分组后面的超链接时，在子页面中要显示该地区选中字段的详细信息，即通过超链接把主页面中的条件传递给了子页面作为其自身的检索条件，选择按运货商分组时效果也是同样。如下图所示：</p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/06/12.png" alt="1.png" height="544" /></p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/06/22.png" alt="2.png" height="584" /></p> 
   <p>主页面的报表设计界面及超链接定义如下：</p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/06/310.png" alt="3.png" height="162" /></p> 
   <p>定义了一个参数arg1接收页面输入的参数值，并定义了与此参数有关的动态宏macro1：</p> 
   <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/06/4.png" alt="4.png" height="58" /></p> 
   <p>超链接页面的报表设计与上面的类似，通过设置的超链接接收由主页面传递过去的检索条件。</p> 
   <p>在实际应用中，灵活的使用参数与宏机制，可以提高整个报表系统的的页面交互性能，不用写脚本而轻松实现许多复杂的需求。<br /> <span lang="EN-US"></span></p> 
  </div>  
 </body>
</html>