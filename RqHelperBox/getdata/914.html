<html>
 <head></head> 
 <body> 
  <p style="0cm 0cm 0pt">多数据集使用：</p> 
  <p style="0cm 0cm 0pt">不同的报表情况，我们要考虑是用多个数据集来完成报表还是用一条SQL来做报表，这在效率上会有所不同，以下我们看个例子，可以从中比较得到多数据集的使用技巧。</p> 
  <p style="21pt">看如下报表： <br /><img src="http://www.runqian.com.cn/wp-content/uploads/2009/05/1.jpg" alt="1.jpg" height="290" /></p> 
  <p style="center"> </p> 
  <p style="2.0gd">这是一个比较典型的主子报表，主表一条记录对应子表多条记录，是个典型的一对多的关系，再引伸一下，一个主表可以对应多个子表，每个子表都是多条记录。</p> 
  <p style="2.0gd"> </p> 
  <p style="2.0gd">此时做法还是存在两种：</p> 
  <p style="2.0gd">第一种：</p> 
  <p style="list 60.0pt">1、 每个主表和子表分别定义一个数据集，在报表里通过条件把子表和主表关联起来</p> 
  <p style="list 60.0pt">2、 优点：避免了表间叉乘，减少了数据量，加快了取数速度和数据库的运算速度。</p> 
  <p style="list 60.0pt">3、 原因：对于主子报表，主表的字段数一般比较多，而子表一般有多条记录和主表的一条记录关联，同时子表间往往没有关联关系，因此如果叉乘会导致数据量大大增加，在多子表的情况下这个现象尤其明显</p> 
  <p style="list 60.0pt">4、 缺点：子表取数扩展时，需要根据条件和主表记录关联，需要对子表记录进行遍历检索，但是大部分的情况下，主表只有一条记录或者只有十几条记录，因此对子表的遍历检索次数不会很多</p> 
  <p style="2.0gd">第二种：</p> 
  <p style="list 60.0pt">1、 只定义一个数据集，把主表和所有子表叉乘起来</p> 
  <p style="list 60.0pt">2、 缺点：由于子表之间没有关联关系，且主表的字段数比较多，叉乘往往导致记录数呈几何级数增加</p> 
  <p style="list 60.0pt">3、 优点：子表取数扩展时，不需要对子表记录进行遍历扩展，运算速度快点</p> 
  <p style="0cm 0cm 0pt">总结：第一种做法的性能优于第二种。 </p>  
 </body>
</html>