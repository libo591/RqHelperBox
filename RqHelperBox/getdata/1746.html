<html>
 <head></head> 
 <body> 
  <p>润乾报表作为企业级的WEB报表开发工具，在数据筛选，数据统计展示方面有着强大的功能，通常情况下，数据分析和决策都以各种数据的统计图为依据，因此，统计图非常重要，润乾报表支持26种统计图和自定义的统计图，可以满足广大用户的需求，同时，润乾报表在统计图的基础上实现了很多人性化的设计，比如客户常用的各种统计图之间的切换功能。</p> 
  <p>本文通过下面的小例子介绍一下此功能。</p> 
  <p><strong>一、首先看一下效果图</strong></p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/12/13.png" alt="1.png" width="420" height="301" /></p> 
  <p>上图是柱状统计图，我们可以将此统计图转化为区域图，散列图，雷达图等等，下图是转化为的雷达图的显示效果：</p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/12/21.png" alt="2.png" width="431" height="301" /></p> 
  <p><strong>二、实现思路</strong></p> 
  <p>其实利用润乾报表实现此功能非常简单，因为润乾报表已经提供了函数：graph（graphTypeExp），其中参数graphTypeExp整数类型，就是说传递给此函数一个整数，用来代表某一种统计图，整数与统计图的对应关系是已经定义好的，比如整数1代表区域图 ，2代表条形图，3代表三维条形图，7代表柱形图，22代表雷达图（润乾报表的函数可以参考用户手册 表达式及函数）</p> 
  <p>有了此函数，只需要做一个参数模板，动态的为报表模板传递一个整数值，然后就可以实现统计图之间的切换了。</p> 
  <p><strong>三、实现步骤</strong></p> 
  <p>1：做一个含有统计图的报表，命名为”统计图.raq”，并为其设置一个参数arg1，用于传递代表统计图类型的整数。如下图所示：</p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/12/31.png" alt="3.png" width="459" height="277" /></p> 
  <p>其中，最关键的一步是设置arg1为整数类型，然后设置统计图的值表达式为graph(arg1)。</p> 
  <p>2：制作参数模板，并命名为”统计图_arg.raq”，如下图所示：</p> 
  <p><img src="http://www.runqian.com.cn/know-how/wp-content/uploads/2009/12/41.png" alt="4.png" width="456" height="316" /></p> 
  <p>其中，编辑风格选择下拉列表框，代码值为传递的实际值（7、1、3、22是统计图的类型显示值为页面上显示值），最后设置此单元格的WEB变量名为arg1。</p> 
  <p>3：发布报表，点击下拉列表框需要转化的统计图类型，然后点击查询即可看到完美的转化效果</p> 
  <p><strong>四、总结</strong></p> 
  <p>利用润乾内置的graph()函数，为其动态传递一个整数实现在各种统计图之间进行切换，避免了做多个不同的统计图，现在，您只需要传递一个参数就可以实现统计图之间的切换了。</p>  
 </body>
</html>