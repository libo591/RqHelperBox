<html>
 <head></head> 
 <body> 
  <p>&nbsp;&nbsp;&nbsp; AJAX的好处就是异步进行交互，让我们感觉页面并没有其他的动作（刷新），让我们感觉页面做的更友好了，交互性更能跟上现在的web应用。利用AJAX进行校验能够在不刷新页面的情况下完成和服务器端的交互，并根据数据的处理结果按你想要的方式对页面作出即时更改。润乾的填报表校验功能，可以在用户填报数据后及时的完成数据有效性的校验，保证填报数据的正确性并能给客户有效直观的提示，客户端的js校验在填报表中的利用很常见，同样也可以将AJAX校验利用在润乾的填报表中。本文将介绍一个AJAX校验在填报表中使用的实例。<br /> <strong>报表需求：<br /> </strong>在用户信息填报页面实现对输入用户名的校验，查询数据库表，在填报表单中提示填写的用户名在数据库中是否存在。<br /> <strong>需求实现：<br /> </strong>1.&nbsp;报表展现页面（register.jsp）<br /> 部分代码：<br /> &lt;!—引入ajax的js文件&gt;<br /> &lt;script type=”text/javascript” language=”javascript” src=”script/ajax_func.js”&gt;&lt;/script&gt;<br /> &lt;script type=”text/javascript” language=”javascript”&gt;<br /> &nbsp;function doCheck(name)&nbsp;{<br /> &nbsp;&nbsp;var f = document.forms[0];<br /> &nbsp;&nbsp;if (name != “”)&nbsp;{<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; document.getElementById(“report1_B10″).innerHTML=”系统正在处理您的请求，请稍候…”<br /> //确定发送请求的方式和请求页面的URL及参数<br /> &nbsp;&nbsp;&nbsp; send_request(“GET”,”registerCheck.jsp?value=” + name, null, “text”, showFeedbackInfo);<br /> &nbsp;&nbsp;}<br /> &nbsp;&nbsp;else&nbsp;{<br /> &nbsp;&nbsp;&nbsp;document.getElementById(“report1_B10″).innerHTML = “请输入用户名！”;<br /> &nbsp;&nbsp;&nbsp;}<br /> &nbsp;&nbsp;return&nbsp; true;<br /> &nbsp;}&nbsp;<br /> //&nbsp;&nbsp; 处理返回信息的函数<br /> &nbsp;function showFeedbackInfo()&nbsp;{<br /> &nbsp;&nbsp;if (http_request.readyState == 4)&nbsp;&nbsp;{ //&nbsp;&nbsp; 判断对象状态<br /> &nbsp;&nbsp;&nbsp;if (http_request.status == 200)&nbsp;&nbsp;{ //&nbsp;&nbsp; 信息已经成功返回，开始处理信息<br /> //在报表的B10单元格中显示返回的信息&nbsp;&nbsp;<br /> document.getElementById(“report1_B10″).innerHTML = http_request.responseText;<br /> &nbsp;&nbsp;}<br /> &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;else&nbsp;&nbsp;&nbsp;{//请求页面不正常<br /> &nbsp;&nbsp;&nbsp;&nbsp;alert(“您所请求的页面有异常！”);<br /> &nbsp;&nbsp;&nbsp;}<br /> &nbsp;&nbsp;}<br /> &nbsp;}<br /> &lt;/script&gt;<br /> ……<br /> &lt;report:html name=”report1″<br /> &nbsp;&nbsp;reportFileName=”/register.raq”<br /> &nbsp;&nbsp;funcBarLocation=”&quot;<br /> &nbsp;&nbsp;excelPageStyle=”1″<br /> &nbsp;&nbsp;width=”-1″<br /> &nbsp;/&gt;<br /> 2.&nbsp;用户名校验页面（registerCheck.jsp）<br /> 该页面主要是完成数据库查询，根据参数查询数据库看是否有用户名相同的数据库记录，并输出相应信息。<br /> 部分代码：<br /> &nbsp;String value = request.getParameter(“value”);<br /> &nbsp;if (!value.equals(“”)) {<br /> Connection con = null;<br /> &nbsp;try{<br /> &nbsp; Driver driver = (Driver) Class.forName(“org.hsqldb.jdbcDriver”).newInstance();<br /> DriverManager.registerDriver(driver);<br /> &nbsp;con= DriverManager.getConnection(“jdbc:hsqldb:hsql://localhost/runqianDB”,”sa”,”&quot;);<br /> &nbsp;String sql = “SELECT EMPNAME from&nbsp; EMPLOYEE where EMPNAME=’”+value+”‘”;<br /> &nbsp;ResultSet rs=con.createStatement().executeQuery(sql);<br /> &nbsp; if (rs.next()) {<br /> &nbsp;&nbsp;&nbsp; out.print(“该用户名已存在！”);<br /> &nbsp; }<br /> &nbsp;else{&nbsp;&nbsp;&nbsp; out.print(“该用户名可用！”);&nbsp; }<br /> &nbsp;&nbsp; }catch (Exception e){<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();&nbsp; }<br /> &nbsp;}<br /> &nbsp;else {<br /> &nbsp;&nbsp;out.println(“参数错误”);<br /> &nbsp;}<br /> 3.&nbsp;报表模板：<br /> &nbsp;<img src="/wp-content/uploads/2011/08/450da449-9ace-4d47-919d-038b2c041b81.jpg" border="0" alt="" /><br /> 在B4单元格中调用页面封装好的js函数完成AJAX校验<br /> <strong><img src="/wp-content/uploads/2011/08/6c4ecbfb-b12c-4147-acca-ad181cc8186a.jpg" border="0" alt="" />&nbsp;<br /> 实现效果：<br /> </strong>情况一：当数据库中存在相同用户名，提示“该用户名已存在！”<br /> <img src="/wp-content/uploads/2011/08/679e5849-c826-44e4-81ec-d51113a058c2.jpg" border="0" alt="" /><br /> 情况二：当数据库中不存在相同用户名，提示“该用户名可用！”<br /> &nbsp;<br /> <img src="/wp-content/uploads/2011/08/dbf4151c-5cde-4762-987b-77f04797e96d.jpg" border="0" alt="" /><br /> </p>  
 </body>
</html>