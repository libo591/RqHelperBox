<html>
 <head></head> 
 <body> 
  <p class="MsoNormal"><span style="color: #4f81bd;">一：需求背景</span></p> 
  <p class="MsoNormal"><span>客户希望在导出的</span><span>excel</span><span>中实现类似于目录的功能，具体需求，第一个</span><span>sheet</span><span>页是目录结构，第二个</span><span>sheet</span><span>页是具体数据，要求具体数据不分页。</span></p> 
  <p class="MsoNormal"><span>目录结构如下图所示：</span></p> 
  <p class="MsoNormal"><span><img src="/wp-content/uploads/2011/08/c07a6963-4638-42ec-a59f-c8fe0ebde38b.jpg" alt="截图03.jpg" width="553" height="346" /></span></p> 
  <p class="MsoNormal"><span style="color: #4f81bd;">二：解决思路步骤</span></p> 
  <p class="MsoNormal"><span>1</span><span>：提取目录页中的数据和对应页码</span></p> 
  <p class="MsoNormal"><span>润乾报表设置按纸张分页以后，可以得到一个</span><span>IReport[]</span><span>，通过一定的规则，比如字体是黑体则提取出来，做目录的标题，同时可以得到这个目录标题所在的页码。</span></p> 
  <p class="MsoNormal"><span>2</span><span>：创建目录</span><span>sheet</span><span>页</span></p> 
  <p class="MsoNormal"><span>创建一个空白报表对象即</span><span>ReportDefine</span><span>对</span><span style="color: black;">象，提取步骤</span><span style="color: black;">1</span><span style="color: black;">中获得的标题和对应的页面，生成目录页</span></p> 
  <p class="MsoNormal"><span style="color: black;">3</span><span style="color: black;">：创建数据</span><span style="color: black;">sheet</span><span style="color: black;">页</span></p> 
  <p class="MsoNormal"><span style="color: black;">因为如果润乾报表分页后，导出</span><span style="color: black;">excel</span><span style="color: black;">时每页都作为一个单独的</span><span style="color: black;">sheet</span><span style="color: black;">，不符合客户要求，故需要创建一张空白表，遍历出</span><span style="color: black;">IReport[]</span><span style="color: black;">中所有的数据，依次写入空白表中，需要注意的是对合并格的处理。</span></p> 
  <p class="MsoNormal"><span style="color: #4f81bd;">三：具体步骤以及相关代码</span></p> 
  <p class="MsoNormal"><span style="color: black;">Demo</span><span style="color: black;">创建：</span></p> 
  <p class="MsoNormal"><span style="color: black;">为了完成实例，创建报表如下：</span></p> 
  <p class="MsoNormal"><span style="color: black;"><img src="/wp-content/uploads/2011/08/aa3e6d49-106d-4f98-aa08-9ea2aec2b4f5.jpg" alt="" width="534" height="148" /></span></p> 
  <p class="MsoNormal"><span style="color: black;">希望将黑体的货主地区提取出来，并加上对应的页码做目录。</span></p> 
  <p class="MsoNormal"><span style="color: black;">展示后导出到</span><span style="color: black;">excel</span><span style="color: black;">时数据在一个</span><span style="color: black;">sheet</span><span style="color: black;">中，并在每页后面显示页码号。</span></p> 
  <p class="MsoNormal">&nbsp;</p> 
  <p class="MsoNormal"><span style="color: black;">相关代码：</span></p> 
  <p class="MsoNormal"><span style="color: black;">1</span><span style="color: black;">：提取目录页中的数据以及对应页码</span></p> 
  <p class="MsoNormal"><span>读取报表进行运算，得到</span><span>PageBuilder</span><span>对象，通过</span><span>PageBuilder</span><span>对象得到所有的页，遍历某一列得到目录标题，方法如下：</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span></span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">参数，分页后的报表对象，遍历具体列，最终得到页码和每页标题的</span><span style="color: #3f7f5f;">hashmap</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> HashMap&lt;Integer, String&gt; getDir(PageBuilder pb, </span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> colNum) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Map&lt;Integer, String&gt; hm = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> HashMap&lt;Integer, String&gt;();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport[] ireports = </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">try</span></strong><span style="color: black;"> {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ireports = pb.getAllPages();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">catch</span></strong><span style="color: black;"> (Exception e) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>e.printStackTrace();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">获得分页后的所有页集合</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> count = 0;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> i = 0; i &lt; ireports.</span><span style="color: #0000c0;">length</span><span style="color: black;">; i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> r = 1; r &lt; ireports[i].getRowCount(); r++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell ic = ireports[i].getCell(r, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) colNum);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (ic.isBold()) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String dirctory = ic.getValue().toString();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hm.put(count, i + 1 + </span><span style="color: #2a00ff;">“&amp;”</span><span style="color: black;"> + dirctory);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>count++;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> (HashMap&lt;Integer, String&gt;) hm;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">2</span><span style="color: black;">：创建目录</span><span style="color: black;">sheet</span><span style="color: black;">页</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span></span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">参数：创建目录的</span><span style="color: #3f7f5f;">report</span><span style="color: #3f7f5f;">，</span><span style="color: #3f7f5f;">length</span><span style="color: #3f7f5f;">为目录的长度，需要计算出目录中点的个数</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> ReportDefine getIreport(HashMap&lt;Integer, String&gt; map, </span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> length) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Object[] key = map.keySet().toArray();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">数据进行排序，控制页码的顺序</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Arrays.<em>sort</em>(key);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReportDefine dirctoryPage = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> ReportDefine2(key.</span><span style="color: #0000c0;">length</span><span style="color: black;">, 1);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dirctoryPage.getColCell((</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) 1).setColWidth(147);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">因为目录占一页，所以后面的页数加</span><span style="color: #3f7f5f;">1</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> i = 0; i &lt; key.</span><span style="color: #0000c0;">length</span><span style="color: black;">; i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell inc = dirctoryPage.getCell(i + 1, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) 1);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String value = map.get(key[i]);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> page = Integer.<em>parseInt</em>(value.substring(0, value.indexOf(</span><span style="color: #2a00ff;">“&amp;”</span><span style="color: black;">))) + 1;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String pageNum = String.<em>valueOf</em>(page);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String dirName = value.substring(value.indexOf(</span><span style="color: #2a00ff;">“&amp;”</span><span style="color: black;">) + 1);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String dian = getDian(pageNum.length() + dirName.length() + 1,</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>length);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>inc.setValue(dirName + dian + pageNum);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dirctoryPage.setCell((</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) i + 1, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) 1, inc);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> dirctoryPage;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">/* </span><span style="color: black;">用以获取目录中的点</span><span style="color: black;"> */</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">public</span></strong><span style="color: black;"> String getDian(</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> a, </span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> length) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> c = length – a;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>StringBuffer sb = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> StringBuffer();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> i = 0; i &lt; c; i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sb.append(</span><span style="color: #2a00ff;">“.”</span><span style="color: black;">);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">return</span></strong><span style="color: black;"> sb.toString();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span>3</span><span>：创建数据</span><span>sheet</span><span>页</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">IReport[] ireports = pb.getAllPages(); </span><span style="color: #3f7f5f;">// </span><span style="color: #3f7f5f;">获得分页后的所有页集合</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> rowNum = 0, colNum = 0;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">获取页中的行数，列数</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (ireports.</span><span style="color: #0000c0;">length</span><span style="color: black;"> &gt;= 0) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rowNum = ireports[0].getRowCount();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>colNum = ireports[0].getColCount();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> rowNumSum = ireports.</span><span style="color: #0000c0;">length</span><span style="color: black;"> * rowNum;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">创建空白模板</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReportDefine directoryDefine = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> ReportDefine2(rowNumSum, colNum);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">遍历所有页，写入空白模板，并合并单元格</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> i = 0; i &lt; ireports.</span><span style="color: #0000c0;">length</span><span style="color: black;">; i++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IReport ireport = ireports[i];</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> r = 1; r &lt;= ireports[i].getRowCount(); r++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">for</span></strong><span style="color: black;"> (</span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> c = 1; c &lt;= ireport.getColCount(); c++) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INormalCell ic = ireport.getCell(r, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) c);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> temp = i * rowNum + r;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">设置单元格的属性</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>directoryDefine.getCell(temp, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) c)</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.setPropertyMap(ic.getPropertyMap());</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (ic != </span><strong><span style="color: #7f0055;">null</span></strong><span style="color: black;">) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">如果是合并单元格，即做合并单元格操作</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">if</span></strong><span style="color: black;"> (ic.isMerged()) {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">获取合并单元格的区域</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Area area = ic.getMergedArea();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> beginRow = area.getBeginRow();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">int</span></strong><span style="color: black;"> endRow = area.getEndRow();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;"> beginCol = area.getBeginCol();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;"> endCol = area.getEndCol();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Area a = </span><strong><span style="color: #7f0055;">new</span></strong><span style="color: black;"> Area(i * rowNum + beginRow,</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>beginCol, i * rowNum + endRow, endCol);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">写入数据值</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>directoryDefine.getCell(temp, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) c)</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.setValue(ic.getValue());</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">//</span><span style="color: black;">合并单元格区域</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>directoryDefine.getCell(temp, (</span><strong><span style="color: #7f0055;">short</span></strong><span style="color: black;">) c)</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.setMergedArea(a);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="color: black;">4</span><span style="color: black;">：创建</span><span style="color: black;">ExcelReport</span><span style="color: black;">对象，导出目录页以及数据页</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span>ExcelReport excel = new ExcelReport();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span>excel.export(rdf);//</span><span>导出目录页</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span>excel.export(directoryDefine);//</span><span>导出数据页</span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal"><span style="color: #4f81bd;">四：效果图：</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span>1</span><span>：目录页效果图</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span><img src="/wp-content/uploads/2011/08/ee30bbc1-267f-4eb5-bd42-8c623c963d3a.jpg" alt="" width="553" height="370" /></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span>2</span><span>：数据页效果图</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span><img src="/wp-content/uploads/2011/08/4de4d284-0ba6-4fef-81b7-3cd6035e4023.jpg" alt="" width="554" height="403" /></span></p> 
  <p class="MsoNormal"><span style="color: #4f81bd;">五：总结</span></p> 
  <p><span>对于一些非报表通用性问题，我们可以使用</span><span>api</span><span>遍历数据并写入的方法来完成。</span><br /> </p>  
 </body>
</html>