<html>
 <head></head> 
 <body> 
  <h2><span style="font-family: 宋体;">需求背景</span></h2> 
  <p class="MsoNormal"><span><span>&nbsp;</span></span><span style="font-family: 宋体;">有这样一个需求，数据库中存储了相应的键值对，客户希望页面填报的时候只要选择了对应的键，另外单元格的值就自动填写。</span></p> 
  <p class="MsoNormal"><span><span>&nbsp;</span></span><span style="font-family: 宋体;">对于这种键值对的存储，在</span><span>Java</span><span style="font-family: 宋体;">中使用</span><span>Map</span><span style="font-family: 宋体;">可以轻松实现，但是在</span><span>js</span><span style="font-family: 宋体;">中</span><span>Map</span><span style="font-family: 宋体;">就需要自己来实现了。</span></p> 
  <p class="MsoNormal"><span><span>&nbsp;</span></span><span style="font-family: 宋体;">本文即通过实现</span><span>js</span><span style="font-family: 宋体;">的</span><span>Map</span><span style="font-family: 宋体;">数据结构，然后通过单元格的自动计算调用自定义</span><span>js</span><span style="font-family: 宋体;">函数来解决上面提到的需求。</span></p> 
  <h2><span style="font-family: 宋体;">实现步骤</span></h2> 
  <p class="MsoListParagraph" style="text-indent: -18pt; margin-left: 39pt;"><strong><span><span>1、<span style="font: 7pt 'Times New Roman';"> </span></span></span></strong><strong><span style="font-family: 宋体;">设计报表</span></strong></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">要求在页面上输入管号的时候，规格能自动填入。</span><span>B1</span><span style="font-family: 宋体;">和</span><span>C1</span><span style="font-family: 宋体;">分别取出来管号和规格的所有数据，并设其扩展方式为“不可扩展”，详见下图，具体用途在下面详细说明。</span></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"><img class="alignnone size-full wp-image-6602" title="18" src="http://www.runqian.com.cn/know-how/wp-content/uploads/2011/02/18.jpg" alt="18" width="553" height="145" /></p> 
  <p class="MsoListParagraph" style="text-indent: -18pt; margin-left: 39pt;"><strong><span><span>2、<span style="font: 7pt 'Times New Roman';"> </span></span></span></strong><strong><span>js</span></strong><strong><span style="font-family: 宋体;">中</span><span>Map</span></strong><strong><span style="font-family: 宋体;">实现</span></strong></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">实现上面的需求只需要</span><span>Map</span><span style="font-family: 宋体;">的创建，以及</span><span>Map</span><span style="font-family: 宋体;">的</span><span>put</span><span style="font-family: 宋体;">和</span><span>get</span><span style="font-family: 宋体;">方法，这里只贴出这几点的具体实现，</span><span>Map</span><span style="font-family: 宋体;">的完整实现见文章最后。</span></p> 
  <p class="MsoNormal" style="text-align: left; margin-left: 21pt;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Map() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;"><span>&nbsp;</span>this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Array();<span> </span></span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"> </p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;</span><span>&nbsp;</span></span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">向</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中增加元素（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">key, value)<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span>&nbsp;</span><span>&nbsp;</span></span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.put = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_key, _value) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;"><span>&nbsp;</span>this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.push(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">key:_key, value:_value</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">);</span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;</span></span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"> </p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;"><span>&nbsp;</span></span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素值</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">NULL<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span>&nbsp;</span></span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.get = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;"><span>&nbsp;</span>try {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;"><span>&nbsp;</span>for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;"><span>&nbsp;</span>if </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].key == _key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].value;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">catch </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(e) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return null</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体; color: black; font-size: 10pt;">……</span></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"> </p> 
  <p class="MsoListParagraph" style="text-indent: -18pt; margin-left: 39pt;"><strong><span><span>3、<span style="font: 7pt 'Times New Roman';"> </span></span></span></strong><strong><span style="font-family: 宋体;">发布报表的页面实现我们的需求</span></strong></p> 
  <p class="MsoNormal" style="text-indent: 21pt;"><span style="font-family: 宋体;">发布报表完整</span><span>jsp</span><span style="font-family: 宋体;">我们不再赘述，这里只看自定义</span><span>js</span><span style="font-family: 宋体;">函数的实现</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">/**</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">&nbsp;</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">参数说明：</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">keys</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">：报表中传递过来的键串，即</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">B1</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中的管号值</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">values</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">：报表中传递过来的值串，即</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">C1</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中的规格值</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">key</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">：页面上选择的键值，用于查找对应的值</span></p> 
  <p class="MsoNormal"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">*/</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">write(keys,values,key)</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">将取出的键值字符串分别存入键值数组</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr_keys = keys.split(</span><span style="font-family: 'Courier New'; color: #8e00ff; font-size: 10pt;">“,”</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr_values = values.split(</span><span style="font-family: 'Courier New'; color: #8e00ff; font-size: 10pt;">“,”</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">取键数组长度，若值数组长度超出，则舍弃</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">length = arr_keys.length;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">新建</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">map</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">对象</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">map = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Map();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">将键值数组存入</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">map</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">&nbsp;</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">i=0;i&lt;length;i++)</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">map.put(arr_keys[i],arr_values[i]);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">map.get(key);</span></p> 
  <p class="MsoNormal"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoListParagraph" style="text-indent: -18pt; margin-left: 39pt;"><span><span>4、<span style="font: 7pt 'Times New Roman';"> </span></span></span><span style="font-family: 宋体;">在自动计算中调用自定义</span><span>js</span><span style="font-family: 宋体;">函数</span></p> 
  <p class="MsoNormal" style="margin-left: 21pt;"><span style="font-family: 宋体;">最后我们在报表单元格</span><span>C3</span><span style="font-family: 宋体;">的自动计算中调用上面定义的</span><span>js</span><span style="font-family: 宋体;">函数即可，见下图。</span></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"><img class="alignnone size-full wp-image-6599" title="17" src="http://www.runqian.com.cn/know-how/wp-content/uploads/2011/02/17.jpg" alt="17" width="554" height="222" /></p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"> </p> 
  <p class="MsoNormal"><strong><span style="font-family: 宋体;">另附</span><span>Map</span></strong><strong><span style="font-family: 宋体;">实现完整代码：</span></strong></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">/*<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">对象，实现</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">功能</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* written by saint</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">*<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">接口：</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* size()<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">元素个数</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* isEmpty()<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">判断</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">是否为空</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* clear()<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">删除</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">所有元素</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* put(key, value)<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">向</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中增加元素（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">key, value)<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* remove(key)<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">删除指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素，成功返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">True</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">False<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* get(key)<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素值</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">NULL<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* element(index)<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取指定索引的元素（使用</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">element.key</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">element.value</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">和</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">），失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">NULL<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* containsKey(key)<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">判断</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中是否含有指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* containsValue(value) </span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">判断</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中是否含有指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* values()<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中所有</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的数组（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">ARRAY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">）</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* keys()<span> </span></span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中所有</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的数组（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">ARRAY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">）</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">*<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">. * </span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">例子：</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">. * var map = new Map();<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">*<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* map.put(“key”, “value”);<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* var val = map.get(“key”)<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">* ……<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">*<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">*/</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Map() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Array();<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">元素个数</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.size = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">判断</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">是否为空</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.isEmpty = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length &lt; 1);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">删除</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">所有元素</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.clear = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Array();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">向</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中增加元素（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">key, value)<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.put = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_key, _value) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.push(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">key:_key, value:_value</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">删除指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素，成功返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">True</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">False<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.remove = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">false</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">try {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].key == _key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.splice(i, 1);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return true</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">catch </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(e) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">false</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素值</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">NULL<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.get = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">try {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].key == _key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].value;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">catch </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(e) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return null</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取指定索引的元素（使用</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">element.key</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">，</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">element.value</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">和</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">），失败返回</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">NULL<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.element = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_index) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_index &lt; 0 || _index &gt;= </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return null</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[_index];</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">判断</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中是否含有指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.containsKey = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">false</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">try {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].key == _key) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">true</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">catch </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(e) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">false</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">判断</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中是否含有指定</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的元素</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.containsValue = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(_value) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">false</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">try {</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">if </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].value == _value) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">true</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">catch </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(e) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">false</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">bln;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中所有</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">VALUE</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的数组（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">ARRAY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">）</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.values = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Array();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr.push(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].value);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;<span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;">&nbsp;</p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">//</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">获取</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">MAP</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">中所有</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">KEY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">的数组（</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;">ARRAY</span><span style="font-family: 宋体; color: #3f5fbf; font-size: 10pt;">）</span><span style="font-family: 'Courier New'; color: #3f5fbf; font-size: 10pt;"><span> </span></span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.keys = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">function </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">() </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Array();</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">for </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">(i = 0; i &lt; </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements.length; i++) </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">{</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr.push(</span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">this</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">.elements[i].key);</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">return </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">arr;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">;</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">}</span></p> 
  <p class="MsoNormal" style="text-align: left;"><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">var </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">map = </span><span style="font-family: 'Courier New'; color: #7f0055; font-size: 10pt;">new </span><span style="font-family: 'Courier New'; color: black; font-size: 10pt;">Map();</span></p>  
 </body>
</html>